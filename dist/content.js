(()=>{console.log("IP Graph content script loaded");const n={ethereum:/0x[a-fA-F0-9]{40}/g,ensName:/[a-zA-Z0-9-]+\.eth/g,storyIP:/0x[a-fA-F0-9]{40}/g};let e=[],t=null,i=null;function o(){a(),new MutationObserver(n=>{let e=!1;n.forEach(n=>{if("childList"===n.type&&n.addedNodes.length>0)for(const t of n.addedNodes)if(t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ELEMENT_NODE&&t.textContent){e=!0;break}}),e&&(i&&clearTimeout(i),i=window.setTimeout(()=>{a()},1e3))}).observe(document.body,{childList:!0,subtree:!0}),chrome.runtime.onMessage.addListener((n,t,i)=>{switch(n.action){case"getDetectedIPs":i({ips:e,url:window.location.href,title:document.title});break;case"highlightIP":if(n.ip){const t=e.find(e=>e.ip===n.ip);t&&(t.element.scrollIntoView({behavior:"smooth",block:"center"}),t.element.style.animation="pulse 2s ease-in-out")}break;case"clearHighlights":document.querySelectorAll(".ip-graph-highlight").forEach(n=>{const e=n.parentNode;e&&(e.replaceChild(document.createTextNode(n.textContent||""),n),e.normalize())})}return!0}),console.log("IP Graph content script initialized")}function a(){const i=[],o=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,{acceptNode:n=>{const e=n.parentElement;return e&&["SCRIPT","STYLE","NOSCRIPT"].includes(e.tagName)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),a=[];let c;for(;c=o.nextNode();)a.push(c);a.forEach(e=>{const t=e.textContent||"",o=e.parentElement;if(o)for(const[e,a]of Object.entries(n)){let n;for(a.lastIndex=0;null!==(n=a.exec(t));){const a=n[0],d=n.index,s=Math.max(0,d-30),c=Math.min(t.length,d+a.length+30),l=t.slice(s,c).trim();i.find(n=>n.ip===a)||(i.push({ip:a,type:e,element:o,context:l}),r(o,a))}}}),e=i,e.length>0&&(t&&t.remove(),0!==e.length&&(t=document.createElement("div"),t.id="ip-graph-indicator",t.innerHTML=`\n    <div class="indicator-content">\n      <div class="indicator-icon">üìä</div>\n      <div class="indicator-text">\n        <div class="indicator-count">${e.length}</div>\n        <div class="indicator-label">IP${e.length>1?"s":""} detected</div>\n      </div>\n      <div class="indicator-actions">\n        <button class="indicator-btn analyze-all" title="Analyze All">üîç</button>\n        <button class="indicator-btn close-indicator" title="Close">‚úï</button>\n      </div>\n    </div>\n    <div class="indicator-dropdown">\n      ${e.slice(0,5).map((n,e)=>`\n        <div class="ip-item" data-ip="${n.ip}">\n          <div class="ip-address">${n.ip.slice(0,10)}...${n.ip.slice(-8)}</div>\n          <div class="ip-type">${n.type}</div>\n          <div class="ip-context">${n.context.slice(0,50)}...</div>\n        </div>\n      `).join("")}\n      ${e.length>5?`<div class="ip-item more">+${e.length-5} more...</div>`:""}\n    </div>\n  `,t.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: white;\n    border-radius: 12px;\n    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);\n    z-index: 10000;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    min-width: 280px;\n    max-width: 350px;\n    border: 1px solid #e5e7eb;\n    animation: slideInRight 0.3s ease;\n  ",function(){if(!t)return;const n=t.querySelector(".indicator-content"),i=t.querySelector(".indicator-dropdown");n?.addEventListener("click",n=>{n.target.classList.contains("indicator-btn")||i?.classList.toggle("show")});const o=t.querySelector(".analyze-all");o?.addEventListener("click",n=>{n.stopPropagation(),0!==e.length&&(d(e[0].ip),s(`Analyzing ${e.length} detected IP${e.length>1?"s":""}...`))});const a=t.querySelector(".close-indicator");a?.addEventListener("click",n=>{n.stopPropagation(),t?.remove()}),t.querySelectorAll(".ip-item[data-ip]").forEach(n=>{n.addEventListener("click",()=>{const e=n.getAttribute("data-ip");e&&d(e)})})}(),document.body.appendChild(t),setTimeout(()=>{t&&t.parentNode&&(t.style.animation="slideOutRight 0.3s ease",setTimeout(()=>{t&&t.parentNode&&t.remove()},300))},1e4)),chrome.runtime.sendMessage({action:"ipsDetected",ips:e.map(n=>({ip:n.ip,type:n.type,context:n.context})),url:window.location.href,title:document.title}))}function r(n,e){const t=(n.textContent||"").indexOf(e);if(-1!==t)try{const i=document.createRange(),o=document.createTreeWalker(n,NodeFilter.SHOW_TEXT);let a,r=0;for(;a=o.nextNode();){const n=(a.textContent||"").length;if(r<=t&&t<r+n){const n=t-r,o=n+e.length;i.setStart(a,n),i.setEnd(a,o);const s=document.createElement("span");s.className="ip-graph-highlight",s.style.cssText="\n          background: linear-gradient(135deg, #667eea, #764ba2);\n          color: white;\n          padding: 2px 4px;\n          border-radius: 3px;\n          font-weight: 600;\n          cursor: pointer;\n          transition: all 0.2s ease;\n        ",s.title=`IP Address: ${e}\nClick to analyze`,s.addEventListener("click",()=>d(e)),s.addEventListener("mouseenter",()=>{s.style.transform="scale(1.05)",s.style.boxShadow="0 2px 8px rgba(102, 126, 234, 0.3)"}),s.addEventListener("mouseleave",()=>{s.style.transform="scale(1)",s.style.boxShadow="none"});try{i.surroundContents(s)}catch(n){s.textContent=e,i.deleteContents(),i.insertNode(s)}break}r+=n}}catch(n){console.warn("Failed to highlight IP:",n)}}function d(n){chrome.runtime.sendMessage({action:"analyzeIP",ipId:n},e=>{e?.success&&s(`Analyzing IP: ${n.slice(0,10)}...`)})}function s(n){const e=document.createElement("div");e.style.cssText="\n    position: fixed;\n    top: 80px;\n    right: 20px;\n    background: linear-gradient(135deg, #667eea, #764ba2);\n    color: white;\n    padding: 12px 20px;\n    border-radius: 8px;\n    font-size: 14px;\n    font-weight: 600;\n    z-index: 10001;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n    animation: slideInRight 0.3s ease;\n    max-width: 300px;\n  ",e.textContent=n,document.body.appendChild(e),setTimeout(()=>{e.style.animation="slideOutRight 0.3s ease",setTimeout(()=>{e.parentNode&&e.remove()},300)},3e3)}function c(){if(document.getElementById("ip-graph-content-styles"))return;const n=document.createElement("style");n.id="ip-graph-content-styles",n.textContent="\n    @keyframes slideInRight {\n      from {\n        transform: translateX(100%);\n        opacity: 0;\n      }\n      to {\n        transform: translateX(0);\n        opacity: 1;\n      }\n    }\n\n    @keyframes slideOutRight {\n      from {\n        transform: translateX(0);\n        opacity: 1;\n      }\n      to {\n        transform: translateX(100%);\n        opacity: 0;\n      }\n    }\n\n    @keyframes pulse {\n      0%, 100% { transform: scale(1); }\n      50% { transform: scale(1.05); }\n    }\n\n    #ip-graph-indicator .indicator-content {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      padding: 15px;\n      cursor: pointer;\n      transition: background 0.2s ease;\n    }\n\n    #ip-graph-indicator .indicator-content:hover {\n      background: #f8f9fa;\n    }\n\n    #ip-graph-indicator .indicator-icon {\n      font-size: 20px;\n    }\n\n    #ip-graph-indicator .indicator-text {\n      flex: 1;\n    }\n\n    #ip-graph-indicator .indicator-count {\n      font-size: 18px;\n      font-weight: bold;\n      color: #667eea;\n    }\n\n    #ip-graph-indicator .indicator-label {\n      font-size: 12px;\n      color: #666;\n    }\n\n    #ip-graph-indicator .indicator-actions {\n      display: flex;\n      gap: 8px;\n    }\n\n    #ip-graph-indicator .indicator-btn {\n      background: #f3f4f6;\n      border: none;\n      border-radius: 6px;\n      padding: 6px 8px;\n      cursor: pointer;\n      font-size: 12px;\n      transition: all 0.2s ease;\n    }\n\n    #ip-graph-indicator .indicator-btn:hover {\n      background: #e5e7eb;\n      transform: scale(1.05);\n    }\n\n    #ip-graph-indicator .indicator-dropdown {\n      display: none;\n      border-top: 1px solid #e5e7eb;\n      max-height: 200px;\n      overflow-y: auto;\n    }\n\n    #ip-graph-indicator .indicator-dropdown.show {\n      display: block;\n    }\n\n    #ip-graph-indicator .ip-item {\n      padding: 12px 15px;\n      border-bottom: 1px solid #f3f4f6;\n      cursor: pointer;\n      transition: background 0.2s ease;\n    }\n\n    #ip-graph-indicator .ip-item:hover {\n      background: #f8f9fa;\n    }\n\n    #ip-graph-indicator .ip-item:last-child {\n      border-bottom: none;\n    }\n\n    #ip-graph-indicator .ip-address {\n      font-family: monospace;\n      font-size: 12px;\n      font-weight: 600;\n      color: #333;\n      margin-bottom: 4px;\n    }\n\n    #ip-graph-indicator .ip-type {\n      font-size: 10px;\n      color: #667eea;\n      font-weight: 600;\n      text-transform: uppercase;\n      margin-bottom: 4px;\n    }\n\n    #ip-graph-indicator .ip-context {\n      font-size: 11px;\n      color: #666;\n      line-height: 1.3;\n    }\n\n    #ip-graph-indicator .ip-item.more {\n      text-align: center;\n      color: #667eea;\n      font-weight: 600;\n      font-size: 12px;\n    }\n  ",document.head.appendChild(n)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{c(),o()}):(c(),o())})();
//# sourceMappingURL=content.js.map