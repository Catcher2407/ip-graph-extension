(()=>{"use strict";var t,e,n={},r={};function i(t){var e=r[t];if(void 0!==e)return e.exports;var a=r[t]={exports:{}};return n[t].call(a.exports,a,a.exports,i),a.exports}i.m=n,i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.f={},i.e=t=>Promise.all(Object.keys(i.f).reduce((e,n)=>(i.f[n](t,e),e),[])),i.u=t=>t+".js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="ip-graph-extension:",i.l=(n,r,a,o)=>{if(t[n])t[n].push(r);else{var s,c;if(void 0!==a)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==e+a){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",e+a),s.src=n),t[n]=[r];var h=(e,r)=>{s.onerror=s.onload=null,clearTimeout(f);var i=t[n];if(delete t[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach(t=>t(r)),e)return e(r)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=n[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),(()=>{var t={887:0};i.f.j=(e,n)=>{var r=i.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise((n,i)=>r=t[e]=[n,i]);n.push(r[2]=a);var o=i.p+i.u(e),s=new Error;i.l(o,n=>{if(i.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,r[1](s)}},"chunk-"+e,e)}};var e=(e,n)=>{var r,a,[o,s,c]=n,l=0;if(o.some(e=>0!==t[e])){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);c&&c(i)}for(e&&e(n);l<o.length;l++)a=o[l],i.o(t,a)&&t[a]&&t[a][0](),t[a]=0},n=self.webpackChunkip_graph_extension=self.webpackChunkip_graph_extension||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var a={};i.r(a),i.d(a,{hasBrowserEnv:()=>ji,hasStandardBrowserEnv:()=>Ui,hasStandardBrowserWebWorkerEnv:()=>qi,navigator:()=>Fi,origin:()=>Hi});let o=null,s=null;const c=1315,l="https://aeneid.storyrpc.io",u="872dd7b79a4f1baa768efecf082ed91f";function d(){const t=g("âš ï¸ Please switch to Story Aeneid Testnet","error");document.body.appendChild(t),setTimeout(()=>{t.remove()},5e3)}function h(){o=null,s=null,p("connecting","Disconnected"),f();const t=document.getElementById("ip-details");t&&(t.innerHTML='\n      <div class="placeholder">\n        <span class="placeholder-icon">ðŸŽ¯</span>\n        <p>Connect wallet and search for an IP Asset to see its relationship graph</p>\n      </div>\n    '),function(){const t=g("ðŸ”Œ Disconnected from Story Protocol","info");document.body.appendChild(t),setTimeout(()=>{t.remove()},2e3)}()}function f(){const t=document.getElementById("wallet-status"),e=document.getElementById("connection-status"),n=document.getElementById("wallet-address"),r=document.getElementById("wallet-balance"),i=document.getElementById("wallet-network"),a=document.getElementById("connect-wallet"),s=document.getElementById("disconnect-wallet"),c=document.getElementById("wallet-address-item"),l=document.getElementById("wallet-balance-item"),u=document.getElementById("wallet-network-item");o?.connected?(t&&(t.className="wallet-status connected"),e&&(e.textContent=`Connected via ${o.provider}`),n&&(n.textContent=`${o.address.slice(0,6)}...${o.address.slice(-4)}`),r&&(r.textContent=`${o.balance} IP`),i&&(i.textContent="Story Aeneid Testnet"),c&&(c.style.display="flex"),l&&(l.style.display="flex"),u&&(u.style.display="flex"),a&&(a.style.display="none"),s&&(s.style.display="block")):(t&&(t.className="wallet-status"),e&&(e.textContent="Connect to Story Protocol"),c&&(c.style.display="none"),l&&(l.style.display="none"),u&&(u.style.display="none"),a&&(a.style.display="block"),s&&(s.style.display="none"))}function p(t,e){const n=document.getElementById("wallet-status"),r=document.getElementById("connection-status");n&&(n.className=`wallet-status ${t}`),r&&(r.textContent=e)}function v(){const t=g(`âœ… Connected via ${o?.provider}!`,"success");document.body.appendChild(t),setTimeout(()=>{t.remove()},3e3)}function m(t){let e="Connection failed. Please try again.";t.message&&(t.message.includes("User rejected")?e="Connection cancelled by user.":t.message.includes("MetaMask not found")?e="Please install MetaMask extension.":t.message.includes("No accounts found")&&(e="Please unlock your wallet and try again."));const n=g(`âŒ ${e}`,"error");document.body.appendChild(n),setTimeout(()=>{n.remove()},4e3)}function g(t,e){const n=document.createElement("div");return n.className=`notification notification-${e}`,n.textContent=t,n.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    padding: 16px 24px;\n    border-radius: 12px;\n    color: white;\n    font-weight: 600;\n    font-size: 14px;\n    z-index: 10001;\n    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n    animation: slideInRight 0.3s ease;\n    max-width: 300px;\n  ",n.style.background={success:"linear-gradient(135deg, #10b981, #059669)",error:"linear-gradient(135deg, #ef4444, #dc2626)",info:"linear-gradient(135deg, #3b82f6, #1d4ed8)"}[e],n}async function y(){if(o?.connected)try{console.log("Loading user IP assets for:",o.address);const t=await async function(t){try{const e=[`https://api.storyapis.com/assets/owner/${t}`,`https://api.storyapis.com/ip-assets/owner/${t}`,`https://api.storyapis.com/users/${t}/assets`,`https://api.storyapis.com/v1/assets?owner=${t}`],n={"X-CHAIN":"story-aeneid","X-API-Key":"MhBsxkU1z9fG6TofE59KqiiWV-YlYE8Q4awlLQehF3U","Content-Type":"application/json"};for(const t of e)try{console.log(`Trying user assets endpoint: ${t}`);const e=await fetch(t,{headers:n});if(e.ok){const t=await e.json();return console.log("User assets response:",t),(Array.isArray(t)?t:t.assets||t.data||[]).map(t=>({id:t.id||t.ipId,name:t.name||t.metadata?.title||`IP Asset ${t.id?.slice(0,8)}...`,derivatives:t.derivatives||[],totalRevenue:t.totalRevenue||t.revenue||"0",type:t.type||"IP Asset",createdAt:t.createdAt,metadata:t.metadata}))}}catch(e){console.log(`Endpoint ${t} failed:`,e);continue}return[]}catch(t){return console.error("Error fetching user IP assets:",t),[]}}(o.address);t.length>0?function(t){const e=document.getElementById("user-ip-assets")||document.getElementById("ip-details");if(!e)return;let n='<div class="user-assets">';n+="<h3>ðŸ“‹ Your Story IP Assets</h3>",n+=`<div class="assets-count">${t.length} IP Asset${1!==t.length?"s":""} found</div>`,n+='<div class="assets-list">',t.forEach((t,e)=>{n+=`\n      <div class="asset-item" data-ip-id="${t.id}">\n        <div class="asset-header">\n          <div class="asset-name">${t.name||`IP Asset #${e+1}`}</div>\n          <div class="asset-type">${t.type||"IP Asset"}</div>\n        </div>\n        <div class="asset-id">${t.id.slice(0,10)}...${t.id.slice(-8)}</div>\n        <div class="asset-stats">\n          <span>ðŸ“Š Derivatives: ${t.derivatives?.length||0}</span>\n          <span>ðŸ’° Revenue: ${t.totalRevenue||"0"} IP</span>\n        </div>\n        ${t.createdAt?`<div class="asset-date">Created: ${new Date(t.createdAt).toLocaleDateString()}</div>`:""}\n      </div>\n    `}),n+="</div>",n+="</div>",e.innerHTML=n,document.querySelectorAll(".asset-item").forEach(t=>{t.addEventListener("click",t=>{const e=t.currentTarget.getAttribute("data-ip-id");e&&function(t){const e=document.getElementById("search"),n=document.getElementById("visualize");e&&(e.value=t),n&&n.click()}(e)})})}(t):w()}catch(t){console.error("Failed to load user IP assets:",t),w()}}function w(){const t=document.getElementById("user-ip-assets")||document.getElementById("ip-details");t&&(t.innerHTML='\n    <div class="user-assets">\n      <h3>ðŸ“‹ Your Story IP Assets</h3>\n      <div class="empty-state">\n        <div class="empty-icon">ðŸŽ¨</div>\n        <h4>No IP Assets Found</h4>\n        <p>You don\'t own any IP Assets on Story Protocol yet.</p>\n        <div class="empty-actions">\n          <button class="create-ip-btn" onclick="window.open(\'https://story.foundation\', \'_blank\')">\n            Create Your First IP\n          </button>\n          <button class="refresh-btn" onclick="loadUserIPAssets()">\n            ðŸ”„ Refresh\n          </button>\n        </div>\n      </div>\n    </div>\n  ')}const x=document.createElement("style");function b(){}function _(t){return null==t?b:function(){return this.querySelector(t)}}function E(){return[]}function k(t){return null==t?E:function(){return this.querySelectorAll(t)}}function S(t){return function(){return this.matches(t)}}function A(t){return function(e){return e.matches(t)}}x.textContent="\n  @keyframes slideInRight {\n    from {\n      transform: translateX(100%);\n      opacity: 0;\n    }\n    to {\n      transform: translateX(0);\n      opacity: 1;\n    }\n  }\n  \n  .user-assets {\n    margin-top: 15px;\n  }\n  \n  .user-assets h3 {\n    margin-bottom: 12px;\n    color: #333;\n    font-size: 14px;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n  }\n  \n  .assets-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n  }\n  \n  .asset-item {\n    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n    padding: 12px;\n    border-radius: 8px;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    border: 1px solid #dee2e6;\n  }\n  \n  .asset-item:hover {\n    background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n  }\n  \n  .asset-name {\n    font-weight: 600;\n    font-size: 13px;\n    color: #333;\n    margin-bottom: 6px;\n  }\n  \n  .asset-id {\n    font-family: monospace;\n    font-size: 10px;\n    color: #666;\n    margin-bottom: 8px;\n    background: rgba(255,255,255,0.7);\n    padding: 2px 6px;\n    border-radius: 4px;\n    display: inline-block;\n  }\n  \n  .asset-stats {\n    display: flex;\n    justify-content: space-between;\n    font-size: 11px;\n    color: #555;\n    font-weight: 500;\n  }\n  \n  .asset-stats span {\n    display: flex;\n    align-items: center;\n    gap: 2px;\n  }\n",document.head.appendChild(x);var P=Array.prototype.find;function R(){return this.firstElementChild}var T=Array.prototype.filter;function I(){return Array.from(this.children)}function $(t){return new Array(t.length)}function N(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function M(t,e,n,r,i,a){for(var o,s=0,c=e.length,l=a.length;s<l;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new N(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function C(t,e,n,r,i,a,o){var s,c,l,u=new Map,d=e.length,h=a.length,f=new Array(d);for(s=0;s<d;++s)(c=e[s])&&(f[s]=l=o.call(c,c.__data__,s,e)+"",u.has(l)?i[s]=c:u.set(l,c));for(s=0;s<h;++s)l=o.call(t,a[s],s,a)+"",(c=u.get(l))?(r[s]=c,c.__data__=a[s],u.delete(l)):n[s]=new N(t,a[s]);for(s=0;s<d;++s)(c=e[s])&&u.get(f[s])===c&&(i[s]=c)}function O(t){return t.__data__}function z(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function L(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}N.prototype={constructor:N,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var D="http://www.w3.org/1999/xhtml";const B={svg:"http://www.w3.org/2000/svg",xhtml:D,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function j(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),B.hasOwnProperty(e)?{space:B[e],local:t}:t}function F(t){return function(){this.removeAttribute(t)}}function U(t){return function(){this.removeAttributeNS(t.space,t.local)}}function q(t,e){return function(){this.setAttribute(t,e)}}function H(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function V(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function G(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function X(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function W(t){return function(){this.style.removeProperty(t)}}function Y(t,e,n){return function(){this.style.setProperty(t,e,n)}}function J(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function K(t,e){return t.style.getPropertyValue(e)||X(t).getComputedStyle(t,null).getPropertyValue(e)}function Q(t){return function(){delete this[t]}}function Z(t,e){return function(){this[t]=e}}function tt(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function et(t){return t.trim().split(/^|\s+/)}function nt(t){return t.classList||new rt(t)}function rt(t){this._node=t,this._names=et(t.getAttribute("class")||"")}function it(t,e){for(var n=nt(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function at(t,e){for(var n=nt(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function ot(t){return function(){it(this,t)}}function st(t){return function(){at(this,t)}}function ct(t,e){return function(){(e.apply(this,arguments)?it:at)(this,t)}}function lt(){this.textContent=""}function ut(t){return function(){this.textContent=t}}function dt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function ht(){this.innerHTML=""}function ft(t){return function(){this.innerHTML=t}}function pt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function vt(){this.nextSibling&&this.parentNode.appendChild(this)}function mt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===D&&e.documentElement.namespaceURI===D?e.createElement(t):e.createElementNS(n,t)}}function yt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function wt(t){var e=j(t);return(e.local?yt:gt)(e)}function xt(){return null}function bt(){var t=this.parentNode;t&&t.removeChild(this)}function _t(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Et(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function kt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function St(t,e,n){return function(){var r,i=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var o=0,s=i.length;o<s;++o)if((r=i[o]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=e);this.addEventListener(t.type,a,n),r={type:t.type,name:t.name,value:e,listener:a,options:n},i?i.push(r):this.__on=[r]}}function At(t,e,n){var r=X(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Pt(t,e){return function(){return At(this,t,e)}}function Rt(t,e){return function(){return At(this,t,e.apply(this,arguments))}}rt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Tt=[null];function It(t,e){this._groups=t,this._parents=e}function $t(){return new It([[document.documentElement]],Tt)}It.prototype=$t.prototype={constructor:It,select:function(t){"function"!=typeof t&&(t=_(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=e[i],c=s.length,l=r[i]=new Array(c),u=0;u<c;++u)(a=s[u])&&(o=t.call(a,a.__data__,u,s))&&("__data__"in a&&(o.__data__=a.__data__),l[u]=o);return new It(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):k(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,s=e[a],c=s.length,l=0;l<c;++l)(o=s[l])&&(r.push(t.call(o,o.__data__,l,s)),i.push(o));return new It(r,i)},selectChild:function(t){return this.select(null==t?R:function(t){return function(){return P.call(this.children,t)}}("function"==typeof t?t:A(t)))},selectChildren:function(t){return this.selectAll(null==t?I:function(t){return function(){return T.call(this.children,t)}}("function"==typeof t?t:A(t)))},filter:function(t){"function"!=typeof t&&(t=S(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,c=r[i]=[],l=0;l<s;++l)(a=o[l])&&t.call(a,a.__data__,l,o)&&c.push(a);return new It(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,O);var n,r=e?C:M,i=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),c=new Array(o),l=new Array(o),u=0;u<o;++u){var d=i[u],h=a[u],f=h.length,p=z(t.call(d,d&&d.__data__,u,i)),v=p.length,m=c[u]=new Array(v),g=s[u]=new Array(v);r(d,h,m,g,l[u]=new Array(f),p,e);for(var y,w,x=0,b=0;x<v;++x)if(y=m[x]){for(x>=b&&(b=x+1);!(w=g[b])&&++b<v;);y._next=w||null}}return(s=new It(s,i))._enter=c,s._exit=l,s},enter:function(){return new It(this._enter||this._groups.map($),this._parents)},exit:function(){return new It(this._exit||this._groups.map($),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,a=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),c=0;c<o;++c)for(var l,u=n[c],d=r[c],h=u.length,f=s[c]=new Array(h),p=0;p<h;++p)(l=u[p]||d[p])&&(f[p]=l);for(;c<i;++c)s[c]=n[c];return new It(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=L);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],c=s.length,l=i[a]=new Array(c),u=0;u<c;++u)(o=s[u])&&(l[u]=o);l.sort(e)}return new It(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=j(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?U:F:"function"==typeof e?n.local?G:V:n.local?H:q)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?W:"function"==typeof e?J:Y)(t,e,null==n?"":n)):K(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Q:"function"==typeof e?tt:Z)(t,e)):this.node()[t]},classed:function(t,e){var n=et(t+"");if(arguments.length<2){for(var r=nt(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?ct:e?ot:st)(n,e))},text:function(t){return arguments.length?this.each(null==t?lt:("function"==typeof t?dt:ut)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?ht:("function"==typeof t?pt:ft)(t)):this.node().innerHTML},raise:function(){return this.each(vt)},lower:function(){return this.each(mt)},append:function(t){var e="function"==typeof t?t:wt(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:wt(t),r=null==e?xt:"function"==typeof e?e:_(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(bt)},clone:function(t){return this.select(t?Et:_t)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?St:kt,r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var c,l=0,u=s.length;l<u;++l)for(r=0,c=s[l];r<o;++r)if((i=a[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"==typeof e?Rt:Pt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],a=0,o=i.length;a<o;++a)(r=i[a])&&(yield r)}};const Nt=$t;var Mt={value:()=>{}};function Ct(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Ot(r)}function Ot(t){this._=t}function zt(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Lt(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Mt,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Ot.prototype=Ct.prototype={constructor:Ot,on:function(t,e){var n,r,i=this._,a=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=a[o]).type)i[n]=Lt(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Lt(i[n],t.name,null);return this}for(;++o<s;)if((n=(t=a[o]).type)&&(n=zt(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ot(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};const Dt=Ct;var Bt,jt,Ft=0,Ut=0,qt=0,Ht=0,Vt=0,Gt=0,Xt="object"==typeof performance&&performance.now?performance:Date,Wt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Yt(){return Vt||(Wt(Jt),Vt=Xt.now()+Gt)}function Jt(){Vt=0}function Kt(){this._call=this._time=this._next=null}function Qt(t,e,n){var r=new Kt;return r.restart(t,e,n),r}function Zt(){Vt=(Ht=Xt.now())+Gt,Ft=Ut=0;try{!function(){Yt(),++Ft;for(var t,e=Bt;e;)(t=Vt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ft}()}finally{Ft=0,function(){for(var t,e,n=Bt,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Bt=e);jt=t,ee(r)}(),Vt=0}}function te(){var t=Xt.now(),e=t-Ht;e>1e3&&(Gt-=e,Ht=t)}function ee(t){Ft||(Ut&&(Ut=clearTimeout(Ut)),t-Vt>24?(t<1/0&&(Ut=setTimeout(Zt,t-Xt.now()-Gt)),qt&&(qt=clearInterval(qt))):(qt||(Ht=Xt.now(),qt=setInterval(te,1e3)),Ft=1,Wt(Zt)))}function ne(t,e,n){var r=new Kt;return e=null==e?0:+e,r.restart(n=>{r.stop(),t(n+e)},e,n),r}Kt.prototype=Qt.prototype={constructor:Kt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Yt():+n)+(null==e?0:+e),this._next||jt===this||(jt?jt._next=this:Bt=this,jt=this),this._call=t,this._time=n,ee()},stop:function(){this._call&&(this._call=null,this._time=1/0,ee())}};var re=Dt("start","end","cancel","interrupt"),ie=[];function ae(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function a(c){var l,u,d,h;if(1!==n.state)return s();for(l in i)if((h=i[l]).name===n.name){if(3===h.state)return ne(a);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[l]):+l<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[l])}if(ne(function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(d=n.tween.length),l=0,u=-1;l<d;++l)(h=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=h);r.length=u+1}}function o(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Qt(function(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)},0,n.time)}(t,n,{name:e,index:r,group:i,on:re,tween:ie,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function oe(t,e){var n=ce(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function se(t,e){var n=ce(t,e);if(n.state>3)throw new Error("too late; already running");return n}function ce(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function le(t,e){var n,r,i,a=t.__transition,o=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}}function ue(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var de,he=180/Math.PI,fe={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function pe(t,e,n,r,i,a){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*he,skewX:Math.atan(c)*he,scaleX:o,scaleY:s}}function ve(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:ue(t,i)},{i:c-2,x:ue(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:ue(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:ue(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:ue(t,n)},{i:s-2,x:ue(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var me=ve(function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?fe:pe(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),ge=ve(function(t){return null==t?fe:(de||(de=document.createElementNS("http://www.w3.org/2000/svg","g")),de.setAttribute("transform",t),(t=de.transform.baseVal.consolidate())?pe((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):fe)},", ",")",")");function ye(t,e){var n,r;return function(){var i=se(this,t),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}i.tween=r}}function we(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=se(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===e){i[c]=s;break}c===l&&i.push(s)}a.tween=i}}function xe(t,e,n){var r=t._id;return t.each(function(){var t=se(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return ce(t,r).value[e]}}function be(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function _e(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ee(){}var ke=.7,Se=1/ke,Ae="\\s*([+-]?\\d+)\\s*",Pe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Re="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Te=/^#([0-9a-f]{3,8})$/,Ie=new RegExp(`^rgb\\(${Ae},${Ae},${Ae}\\)$`),$e=new RegExp(`^rgb\\(${Re},${Re},${Re}\\)$`),Ne=new RegExp(`^rgba\\(${Ae},${Ae},${Ae},${Pe}\\)$`),Me=new RegExp(`^rgba\\(${Re},${Re},${Re},${Pe}\\)$`),Ce=new RegExp(`^hsl\\(${Pe},${Re},${Re}\\)$`),Oe=new RegExp(`^hsla\\(${Pe},${Re},${Re},${Pe}\\)$`),ze={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Le(){return this.rgb().formatHex()}function De(){return this.rgb().formatRgb()}function Be(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Te.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?je(e):3===n?new qe(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Fe(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Fe(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ie.exec(t))?new qe(e[1],e[2],e[3],1):(e=$e.exec(t))?new qe(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Ne.exec(t))?Fe(e[1],e[2],e[3],e[4]):(e=Me.exec(t))?Fe(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ce.exec(t))?Ye(e[1],e[2]/100,e[3]/100,1):(e=Oe.exec(t))?Ye(e[1],e[2]/100,e[3]/100,e[4]):ze.hasOwnProperty(t)?je(ze[t]):"transparent"===t?new qe(NaN,NaN,NaN,0):null}function je(t){return new qe(t>>16&255,t>>8&255,255&t,1)}function Fe(t,e,n,r){return r<=0&&(t=e=n=NaN),new qe(t,e,n,r)}function Ue(t,e,n,r){return 1===arguments.length?((i=t)instanceof Ee||(i=Be(i)),i?new qe((i=i.rgb()).r,i.g,i.b,i.opacity):new qe):new qe(t,e,n,null==r?1:r);var i}function qe(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function He(){return`#${We(this.r)}${We(this.g)}${We(this.b)}`}function Ve(){const t=Ge(this.opacity);return`${1===t?"rgb(":"rgba("}${Xe(this.r)}, ${Xe(this.g)}, ${Xe(this.b)}${1===t?")":`, ${t})`}`}function Ge(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Xe(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function We(t){return((t=Xe(t))<16?"0":"")+t.toString(16)}function Ye(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ke(t,e,n,r)}function Je(t){if(t instanceof Ke)return new Ke(t.h,t.s,t.l,t.opacity);if(t instanceof Ee||(t=Be(t)),!t)return new Ke;if(t instanceof Ke)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new Ke(o,s,c,t.opacity)}function Ke(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Qe(t){return(t=(t||0)%360)<0?t+360:t}function Ze(t){return Math.max(0,Math.min(1,t||0))}function tn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function en(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}be(Ee,Be,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Le,formatHex:Le,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Je(this).formatHsl()},formatRgb:De,toString:De}),be(qe,Ue,_e(Ee,{brighter(t){return t=null==t?Se:Math.pow(Se,t),new qe(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?ke:Math.pow(ke,t),new qe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new qe(Xe(this.r),Xe(this.g),Xe(this.b),Ge(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:He,formatHex:He,formatHex8:function(){return`#${We(this.r)}${We(this.g)}${We(this.b)}${We(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Ve,toString:Ve})),be(Ke,function(t,e,n,r){return 1===arguments.length?Je(t):new Ke(t,e,n,null==r?1:r)},_e(Ee,{brighter(t){return t=null==t?Se:Math.pow(Se,t),new Ke(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?ke:Math.pow(ke,t),new Ke(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new qe(tn(t>=240?t-240:t+120,i,r),tn(t,i,r),tn(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Ke(Qe(this.h),Ze(this.s),Ze(this.l),Ge(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ge(this.opacity);return`${1===t?"hsl(":"hsla("}${Qe(this.h)}, ${100*Ze(this.s)}%, ${100*Ze(this.l)}%${1===t?")":`, ${t})`}`}}));const nn=t=>()=>t;function rn(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):nn(isNaN(t)?e:t)}const an=function t(e){var n=function(t){return 1===(t=+t)?rn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):nn(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=Ue(t)).r,(e=Ue(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=rn(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function on(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Ue(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}on(function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return en((n-r/e)*e,o,i,a,s)}}),on(function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return en((n-r/e)*e,i,a,o,s)}});var sn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cn=new RegExp(sn.source,"g");function ln(t,e){var n,r,i,a=sn.lastIndex=cn.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=sn.exec(t))&&(r=cn.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:ue(n,r)})),a=cn.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function un(t,e){var n;return("number"==typeof e?ue:e instanceof Be?an:(n=Be(e))?(e=n,an):ln)(t,e)}function dn(t){return function(){this.removeAttribute(t)}}function hn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function fn(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttribute(t);return o===a?null:o===r?i:i=e(r=o,n)}}function pn(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===r?i:i=e(r=o,n)}}function vn(t,e,n){var r,i,a;return function(){var o,s,c=n(this);if(null!=c)return(o=this.getAttribute(t))===(s=c+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,c));this.removeAttribute(t)}}function mn(t,e,n){var r,i,a;return function(){var o,s,c=n(this);if(null!=c)return(o=this.getAttributeNS(t.space,t.local))===(s=c+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,c));this.removeAttributeNS(t.space,t.local)}}function gn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function yn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function wn(t,e){return function(){oe(this,t).delay=+e.apply(this,arguments)}}function xn(t,e){return e=+e,function(){oe(this,t).delay=e}}function bn(t,e){return function(){se(this,t).duration=+e.apply(this,arguments)}}function _n(t,e){return e=+e,function(){se(this,t).duration=e}}var En=Nt.prototype.constructor;function kn(t){return function(){this.style.removeProperty(t)}}var Sn=0;function An(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Pn(){return++Sn}var Rn=Nt.prototype;An.prototype=function(t){return Nt().transition(t)}.prototype={constructor:An,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=_(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,c,l=r[o],u=l.length,d=a[o]=new Array(u),h=0;h<u;++h)(s=l[h])&&(c=t.call(s,s.__data__,h,l))&&("__data__"in s&&(c.__data__=s.__data__),d[h]=c,ae(d[h],e,n,h,d,ce(s,n)));return new An(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=k(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var c,l=r[s],u=l.length,d=0;d<u;++d)if(c=l[d]){for(var h,f=t.call(c,c.__data__,d,l),p=ce(c,n),v=0,m=f.length;v<m;++v)(h=f[v])&&ae(h,e,n,v,f,p);a.push(f),o.push(c)}return new An(a,o,e,n)},selectChild:Rn.selectChild,selectChildren:Rn.selectChildren,filter:function(t){"function"!=typeof t&&(t=S(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,c=r[i]=[],l=0;l<s;++l)(a=o[l])&&t.call(a,a.__data__,l,o)&&c.push(a);return new An(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var c,l=e[s],u=n[s],d=l.length,h=o[s]=new Array(d),f=0;f<d;++f)(c=l[f]||u[f])&&(h[f]=c);for(;s<r;++s)o[s]=e[s];return new An(o,this._parents,this._name,this._id)},selection:function(){return new En(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Pn(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],c=s.length,l=0;l<c;++l)if(o=s[l]){var u=ce(o,e);ae(o,t,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new An(r,this._parents,t,n)},call:Rn.call,nodes:Rn.nodes,node:Rn.node,size:Rn.size,empty:Rn.empty,each:Rn.each,on:function(t,e){var n=this._id;return arguments.length<2?ce(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?oe:se;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}(n,t,e))},attr:function(t,e){var n=j(t),r="transform"===n?ge:un;return this.attrTween(t,"function"==typeof e?(n.local?mn:vn)(n,r,xe(this,"attr."+t,e)):null==e?(n.local?hn:dn)(n):(n.local?pn:fn)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=j(t);return this.tween(n,(r.local?gn:yn)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?me:un;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=K(this,t),o=(this.style.removeProperty(t),K(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}(t,r)).on("end.style."+t,kn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,a;return function(){var o=K(this,t),s=n(this),c=s+"";return null==s&&(this.style.removeProperty(t),c=s=K(this,t)),o===c?null:o===r&&c===i?a:(i=c,a=e(r=o,s))}}(t,r,xe(this,"style."+t,e))).each(function(t,e){var n,r,i,a,o="style."+e,s="end."+o;return function(){var c=se(this,t),l=c.on,u=null==c.value[o]?a||(a=kn(e)):void 0;l===n&&i===u||(r=(n=l).copy()).on(s,i=u),c.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,a=n+"";return function(){var o=K(this,t);return o===a?null:o===r?i:i=e(r=o,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function a(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,a,n)),r}return a._value=e,a}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(xe(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=ce(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?ye:we)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?wn:xn)(e,t)):ce(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?bn:_n)(e,t)):ce(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){se(this,t).ease=e}}(e,t)):ce(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;se(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var s={value:o},c={value:function(){0===--i&&a()}};n.each(function(){var n=se(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(c)),n.on=e}),0===i&&a()})},[Symbol.iterator]:Rn[Symbol.iterator]};var Tn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function In(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}Nt.prototype.interrupt=function(t){return this.each(function(){le(this,t)})},Nt.prototype.transition=function(t){var e,n;t instanceof An?(e=t._id,t=t._name):(e=Pn(),(n=Tn).time=Yt(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],c=s.length,l=0;l<c;++l)(o=s[l])&&ae(o,t,e,l,s,n||In(o,e));return new An(r,this._parents,t,e)};const{abs:$n,max:Nn,min:Mn}=Math;function Cn(t){return{type:t}}function On(t){return"string"==typeof t?new It([[document.querySelector(t)]],[document.documentElement]):new It([[t]],Tt)}function zn(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}["w","e"].map(Cn),["n","s"].map(Cn),["n","w","e","s","nw","ne","sw","se"].map(Cn);const Ln={passive:!1},Dn={capture:!0,passive:!1};function Bn(t){t.stopImmediatePropagation()}function jn(t){t.preventDefault(),t.stopImmediatePropagation()}function Fn(t){var e=t.document.documentElement,n=On(t).on("dragstart.drag",jn,Dn);"onselectstart"in e?n.on("selectstart.drag",jn,Dn):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Un(t,e){var n=t.document.documentElement,r=On(t).on("dragstart.drag",null);e&&(r.on("click.drag",jn,Dn),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const qn=t=>()=>t;function Hn(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:a,x:o,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}function Vn(t){return!t.ctrlKey&&!t.button}function Gn(){return this.parentNode}function Xn(t,e){return null==e?{x:t.x,y:t.y}:e}function Wn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Yn(t,e){var n,r=1;function i(){var i,a,o=n.length,s=0,c=0;for(i=0;i<o;++i)s+=(a=n[i]).x,c+=a.y;for(s=(s/o-t)*r,c=(c/o-e)*r,i=0;i<o;++i)(a=n[i]).x-=s,a.y-=c}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i}function Jn(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a,o,s,c,l,u,d,h,f=t._root,p={data:r},v=t._x0,m=t._y0,g=t._x1,y=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((l=e>=(a=(v+g)/2))?v=a:g=a,(u=n>=(o=(m+y)/2))?m=o:y=o,i=f,!(f=f[d=u<<1|l]))return i[d]=p,t;if(s=+t._x.call(null,f.data),c=+t._y.call(null,f.data),e===s&&n===c)return p.next=f,i?i[d]=p:t._root=p,t;do{i=i?i[d]=new Array(4):t._root=new Array(4),(l=e>=(a=(v+g)/2))?v=a:g=a,(u=n>=(o=(m+y)/2))?m=o:y=o}while((d=u<<1|l)==(h=(c>=o)<<1|s>=a));return i[h]=f,i[d]=p,t}function Kn(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Qn(t){return t[0]}function Zn(t){return t[1]}function tr(t,e,n){var r=new er(null==e?Qn:e,null==n?Zn:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function er(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function nr(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}Hn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var rr=tr.prototype=er.prototype;function ir(t){return function(){return t}}function ar(t){return 1e-6*(t()-.5)}function or(t){return t.x+t.vx}function sr(t){return t.y+t.vy}function cr(t){return t.index}function lr(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}rr.copy=function(){var t,e,n=new er(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=nr(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=nr(e));return n},rr.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Jn(this.cover(e,n),e,n,t)},rr.addAll=function(t){var e,n,r,i,a=t.length,o=new Array(a),s=new Array(a),c=1/0,l=1/0,u=-1/0,d=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<c&&(c=r),r>u&&(u=r),i<l&&(l=i),i>d&&(d=i));if(c>u||l>d)return this;for(this.cover(c,l).cover(u,d),n=0;n<a;++n)Jn(this,o[n],s[n],t[n]);return this},rr.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o,s,c=i-n||1,l=this._root;n>t||t>=i||r>e||e>=a;)switch(s=(e<r)<<1|t<n,(o=new Array(4))[s]=l,l=o,c*=2,s){case 0:i=n+c,a=r+c;break;case 1:n=i-c,a=r+c;break;case 2:i=n+c,r=a-c;break;case 3:n=i-c,r=a-c}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},rr.data=function(){var t=[];return this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}),t},rr.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},rr.find=function(t,e,n){var r,i,a,o,s,c,l,u=this._x0,d=this._y0,h=this._x1,f=this._y1,p=[],v=this._root;for(v&&p.push(new Kn(v,u,d,h,f)),null==n?n=1/0:(u=t-n,d=e-n,h=t+n,f=e+n,n*=n);c=p.pop();)if(!(!(v=c.node)||(i=c.x0)>h||(a=c.y0)>f||(o=c.x1)<u||(s=c.y1)<d))if(v.length){var m=(i+o)/2,g=(a+s)/2;p.push(new Kn(v[3],m,g,o,s),new Kn(v[2],i,g,m,s),new Kn(v[1],m,a,o,g),new Kn(v[0],i,a,m,g)),(l=(e>=g)<<1|t>=m)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-l],p[p.length-1-l]=c)}else{var y=t-+this._x.call(null,v.data),w=e-+this._y.call(null,v.data),x=y*y+w*w;if(x<n){var b=Math.sqrt(n=x);u=t-b,d=e-b,h=t+b,f=e+b,r=v.data}}return r},rr.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,a,o,s,c,l,u,d,h,f=this._root,p=this._x0,v=this._y0,m=this._x1,g=this._y1;if(!f)return this;if(f.length)for(;;){if((l=a>=(s=(p+m)/2))?p=s:m=s,(u=o>=(c=(v+g)/2))?v=c:g=c,e=f,!(f=f[d=u<<1|l]))return this;if(!f.length)break;(e[d+1&3]||e[d+2&3]||e[d+3&3])&&(n=e,h=d)}for(;f.data!==t;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):e?(i?e[d]=i:delete e[d],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[h]=f:this._root=f),this):(this._root=i,this)},rr.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},rr.root=function(){return this._root},rr.size=function(){var t=0;return this.visit(function(e){if(!e.length)do{++t}while(e=e.next)}),t},rr.visit=function(t){var e,n,r,i,a,o,s=[],c=this._root;for(c&&s.push(new Kn(c,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(c=e.node,r=e.x0,i=e.y0,a=e.x1,o=e.y1)&&c.length){var l=(r+a)/2,u=(i+o)/2;(n=c[3])&&s.push(new Kn(n,l,u,a,o)),(n=c[2])&&s.push(new Kn(n,r,u,l,o)),(n=c[1])&&s.push(new Kn(n,l,i,a,u)),(n=c[0])&&s.push(new Kn(n,r,i,l,u))}return this},rr.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new Kn(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,c=e.x1,l=e.y1,u=(o+c)/2,d=(s+l)/2;(a=i[0])&&n.push(new Kn(a,o,s,u,d)),(a=i[1])&&n.push(new Kn(a,u,s,c,d)),(a=i[2])&&n.push(new Kn(a,o,d,u,l)),(a=i[3])&&n.push(new Kn(a,u,d,c,l))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},rr.x=function(t){return arguments.length?(this._x=t,this):this._x},rr.y=function(t){return arguments.length?(this._y=t,this):this._y};const ur=4294967296;function dr(t){return t.x}function hr(t){return t.y}var fr=Math.PI*(3-Math.sqrt(5));function pr(t){var e,n,r,i=ir(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vx+=(r[a]-i.x)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=ir(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:ir(+t),o(),a):i},a.x=function(e){return arguments.length?(t="function"==typeof e?e:ir(+e),o(),a):t},a}function vr(t){var e,n,r,i=ir(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vy+=(r[a]-i.y)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=ir(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:ir(+t),o(),a):i},a.y=function(e){return arguments.length?(t="function"==typeof e?e:ir(+e),o(),a):t},a}function mr(t){return((t=Math.exp(t))+1/t)/2}const gr=function t(e,n,r){function i(t,i){var a,o,s=t[0],c=t[1],l=t[2],u=i[0],d=i[1],h=i[2],f=u-s,p=d-c,v=f*f+p*p;if(v<1e-12)o=Math.log(h/l)/e,a=function(t){return[s+t*f,c+t*p,l*Math.exp(e*t*o)]};else{var m=Math.sqrt(v),g=(h*h-l*l+r*v)/(2*l*n*m),y=(h*h-l*l-r*v)/(2*h*n*m),w=Math.log(Math.sqrt(g*g+1)-g),x=Math.log(Math.sqrt(y*y+1)-y);o=(x-w)/e,a=function(t){var r,i=t*o,a=mr(w),u=l/(n*m)*(a*(r=e*i+w,((r=Math.exp(2*r))-1)/(r+1))-function(t){return((t=Math.exp(t))-1/t)/2}(w));return[s+u*f,c+u*p,l*a/mr(e*i+w)]}}return a.duration=1e3*o*e/Math.SQRT2,a}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4),yr=t=>()=>t;function wr(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function xr(t,e,n){this.k=t,this.x=e,this.y=n}xr.prototype={constructor:xr,scale:function(t){return 1===t?this:new xr(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new xr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var br=new xr(1,0,0);function _r(t){t.stopImmediatePropagation()}function Er(t){t.preventDefault(),t.stopImmediatePropagation()}function kr(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Sr(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Ar(){return this.__zoom||br}function Pr(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Rr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Tr(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}xr.prototype;class Ir{constructor(t){this.nodes=[],this.links=[],this.container=t,this.width=t.clientWidth||360,this.height=t.clientHeight||280,this.initializeSVG(),this.initializeSimulation(),this.showPlaceholder()}initializeSVG(){On(this.container).selectAll("*").remove(),this.svg=On(this.container).append("svg").attr("width",this.width).attr("height",this.height).style("background","linear-gradient(135deg, #fafbff 0%, #f0f4ff 100%)").style("border-radius","12px");const t=this.svg.append("defs"),e=t.append("linearGradient").attr("id","rootGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%");e.append("stop").attr("offset","0%").attr("stop-color","#667eea"),e.append("stop").attr("offset","100%").attr("stop-color","#764ba2");const n=t.append("linearGradient").attr("id","parentGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%");n.append("stop").attr("offset","0%").attr("stop-color","#10b981"),n.append("stop").attr("offset","100%").attr("stop-color","#059669");const r=t.append("linearGradient").attr("id","childGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%");r.append("stop").attr("offset","0%").attr("stop-color","#f59e0b"),r.append("stop").attr("offset","100%").attr("stop-color","#d97706");const i=t.append("linearGradient").attr("id","derivativeGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%");i.append("stop").attr("offset","0%").attr("stop-color","#ef4444"),i.append("stop").attr("offset","100%").attr("stop-color","#dc2626");const a=function(){var t,e,n,r=kr,i=Sr,a=Tr,o=Pr,s=Rr,c=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],u=250,d=gr,h=Dt("start","zoom","end"),f=0,p=10;function v(t){t.property("__zoom",Ar).on("wheel.zoom",_,{passive:!1}).on("mousedown.zoom",E).on("dblclick.zoom",k).filter(s).on("touchstart.zoom",S).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",P).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(t,e){return(e=Math.max(c[0],Math.min(c[1],e)))===t.k?t:new xr(e,t.x,t.y)}function g(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new xr(t.k,r,i)}function y(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function w(t,e,n,r){t.on("start.zoom",function(){x(this,arguments).event(r).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).event(r).end()}).tween("zoom",function(){var t=this,a=arguments,o=x(t,a).event(r),s=i.apply(t,a),c=null==n?y(s):"function"==typeof n?n.apply(t,a):n,l=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),u=t.__zoom,h="function"==typeof e?e.apply(t,a):e,f=d(u.invert(c).concat(l/u.k),h.invert(c).concat(l/h.k));return function(t){if(1===t)t=h;else{var e=f(t),n=l/e[2];t=new xr(n,c[0]-e[0]*n,c[1]-e[1]*n)}o.zoom(null,t)}})}function x(t,e,n){return!n&&t.__zooming||new b(t,e)}function b(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=i.apply(t,e),this.taps=0}function _(t,...e){if(r.apply(this,arguments)){var n=x(this,e).event(t),i=this.__zoom,s=Math.max(c[0],Math.min(c[1],i.k*Math.pow(2,o.apply(this,arguments)))),u=zn(t);if(n.wheel)n.mouse[0][0]===u[0]&&n.mouse[0][1]===u[1]||(n.mouse[1]=i.invert(n.mouse[0]=u)),clearTimeout(n.wheel);else{if(i.k===s)return;n.mouse=[u,i.invert(u)],le(this),n.start()}Er(t),n.wheel=setTimeout(function(){n.wheel=null,n.end()},150),n.zoom("mouse",a(g(m(i,s),n.mouse[0],n.mouse[1]),n.extent,l))}}function E(t,...e){if(!n&&r.apply(this,arguments)){var i=t.currentTarget,o=x(this,e,!0).event(t),s=On(t.view).on("mousemove.zoom",function(t){if(Er(t),!o.moved){var e=t.clientX-u,n=t.clientY-d;o.moved=e*e+n*n>f}o.event(t).zoom("mouse",a(g(o.that.__zoom,o.mouse[0]=zn(t,i),o.mouse[1]),o.extent,l))},!0).on("mouseup.zoom",function(t){s.on("mousemove.zoom mouseup.zoom",null),Un(t.view,o.moved),Er(t),o.event(t).end()},!0),c=zn(t,i),u=t.clientX,d=t.clientY;Fn(t.view),_r(t),o.mouse=[c,this.__zoom.invert(c)],le(this),o.start()}}function k(t,...e){if(r.apply(this,arguments)){var n=this.__zoom,o=zn(t.changedTouches?t.changedTouches[0]:t,this),s=n.invert(o),c=n.k*(t.shiftKey?.5:2),d=a(g(m(n,c),o,s),i.apply(this,e),l);Er(t),u>0?On(this).transition().duration(u).call(w,d,o,t):On(this).call(v.transform,d,o,t)}}function S(n,...i){if(r.apply(this,arguments)){var a,o,s,c,l=n.touches,u=l.length,d=x(this,i,n.changedTouches.length===u).event(n);for(_r(n),o=0;o<u;++o)c=[c=zn(s=l[o],this),this.__zoom.invert(c),s.identifier],d.touch0?d.touch1||d.touch0[2]===c[2]||(d.touch1=c,d.taps=0):(d.touch0=c,a=!0,d.taps=1+!!t);t&&(t=clearTimeout(t)),a&&(d.taps<2&&(e=c[0],t=setTimeout(function(){t=null},500)),le(this),d.start())}}function A(t,...e){if(this.__zooming){var n,r,i,o,s=x(this,e).event(t),c=t.changedTouches,u=c.length;for(Er(t),n=0;n<u;++n)i=zn(r=c[n],this),s.touch0&&s.touch0[2]===r.identifier?s.touch0[0]=i:s.touch1&&s.touch1[2]===r.identifier&&(s.touch1[0]=i);if(r=s.that.__zoom,s.touch1){var d=s.touch0[0],h=s.touch0[1],f=s.touch1[0],p=s.touch1[1],v=(v=f[0]-d[0])*v+(v=f[1]-d[1])*v,y=(y=p[0]-h[0])*y+(y=p[1]-h[1])*y;r=m(r,Math.sqrt(v/y)),i=[(d[0]+f[0])/2,(d[1]+f[1])/2],o=[(h[0]+p[0])/2,(h[1]+p[1])/2]}else{if(!s.touch0)return;i=s.touch0[0],o=s.touch0[1]}s.zoom("touch",a(g(r,i,o),s.extent,l))}}function P(t,...r){if(this.__zooming){var i,a,o=x(this,r).event(t),s=t.changedTouches,c=s.length;for(_r(t),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),i=0;i<c;++i)a=s[i],o.touch0&&o.touch0[2]===a.identifier?delete o.touch0:o.touch1&&o.touch1[2]===a.identifier&&delete o.touch1;if(o.touch1&&!o.touch0&&(o.touch0=o.touch1,delete o.touch1),o.touch0)o.touch0[1]=this.__zoom.invert(o.touch0[0]);else if(o.end(),2===o.taps&&(a=zn(a,this),Math.hypot(e[0]-a[0],e[1]-a[1])<p)){var l=On(this).on("dblclick.zoom");l&&l.apply(this,arguments)}}}return v.transform=function(t,e,n,r){var i=t.selection?t.selection():t;i.property("__zoom",Ar),t!==i?w(t,e,n,r):i.interrupt().each(function(){x(this,arguments).event(r).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},v.scaleBy=function(t,e,n,r){v.scaleTo(t,function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)},n,r)},v.scaleTo=function(t,e,n,r){v.transform(t,function(){var t=i.apply(this,arguments),r=this.__zoom,o=null==n?y(t):"function"==typeof n?n.apply(this,arguments):n,s=r.invert(o),c="function"==typeof e?e.apply(this,arguments):e;return a(g(m(r,c),o,s),t,l)},n,r)},v.translateBy=function(t,e,n,r){v.transform(t,function(){return a(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments),l)},null,r)},v.translateTo=function(t,e,n,r,o){v.transform(t,function(){var t=i.apply(this,arguments),o=this.__zoom,s=null==r?y(t):"function"==typeof r?r.apply(this,arguments):r;return a(br.translate(s[0],s[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,l)},r,o)},b.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=On(this.that).datum();h.call(t,this.that,new wr(t,{sourceEvent:this.sourceEvent,target:v,type:t,transform:this.that.__zoom,dispatch:h}),e)}},v.wheelDelta=function(t){return arguments.length?(o="function"==typeof t?t:yr(+t),v):o},v.filter=function(t){return arguments.length?(r="function"==typeof t?t:yr(!!t),v):r},v.touchable=function(t){return arguments.length?(s="function"==typeof t?t:yr(!!t),v):s},v.extent=function(t){return arguments.length?(i="function"==typeof t?t:yr([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),v):i},v.scaleExtent=function(t){return arguments.length?(c[0]=+t[0],c[1]=+t[1],v):[c[0],c[1]]},v.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],v):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},v.constrain=function(t){return arguments.length?(a=t,v):a},v.duration=function(t){return arguments.length?(u=+t,v):u},v.interpolate=function(t){return arguments.length?(d=t,v):d},v.on=function(){var t=h.on.apply(h,arguments);return t===h?v:t},v.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,v):Math.sqrt(f)},v.tapDistance=function(t){return arguments.length?(p=+t,v):p},v}().scaleExtent([.1,4]).on("zoom",t=>{this.svg.select(".main-group").attr("transform",t.transform)});this.svg.call(a),this.svg.append("g").attr("class","main-group")}initializeSimulation(){this.simulation=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,c=Qt(d),l=Dt("tick","end"),u=function(){let t=1;return()=>(t=(1664525*t+1013904223)%ur)/ur}();function d(){h(),l.call("tick",e),n<r&&(c.stop(),l.call("end",e))}function h(r){var c,l,u=t.length;void 0===r&&(r=1);for(var d=0;d<r;++d)for(n+=(a-n)*i,s.forEach(function(t){t(n)}),c=0;c<u;++c)null==(l=t[c]).fx?l.x+=l.vx*=o:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=o:(l.y=l.fy,l.vy=0);return e}function f(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),a=n*fr;e.x=i*Math.cos(a),e.y=i*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,u),e}return null==t&&(t=[]),f(),e={tick:h,restart:function(){return c.restart(d),e},stop:function(){return c.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(a=+t,e):a},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(u=t,s.forEach(p),e):u},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,a,o,s,c,l=0,u=t.length;for(null==r?r=1/0:r*=r,l=0;l<u;++l)(o=(i=e-(s=t[l]).x)*i+(a=n-s.y)*a)<r&&(c=s,r=o);return c},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}}().force("link",function(t){var e,n,r,i,a,o,s=cr,c=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},l=ir(30),u=1;function d(r){for(var i=0,s=t.length;i<u;++i)for(var c,l,d,h,f,p,v,m=0;m<s;++m)l=(c=t[m]).source,h=(d=c.target).x+d.vx-l.x-l.vx||ar(o),f=d.y+d.vy-l.y-l.vy||ar(o),h*=p=((p=Math.sqrt(h*h+f*f))-n[m])/p*r*e[m],f*=p,d.vx-=h*(v=a[m]),d.vy-=f*v,l.vx+=h*(v=1-v),l.vy+=f*v}function h(){if(r){var o,c,l=r.length,u=t.length,d=new Map(r.map((t,e)=>[s(t,e,r),t]));for(o=0,i=new Array(l);o<u;++o)(c=t[o]).index=o,"object"!=typeof c.source&&(c.source=lr(d,c.source)),"object"!=typeof c.target&&(c.target=lr(d,c.target)),i[c.source.index]=(i[c.source.index]||0)+1,i[c.target.index]=(i[c.target.index]||0)+1;for(o=0,a=new Array(u);o<u;++o)c=t[o],a[o]=i[c.source.index]/(i[c.source.index]+i[c.target.index]);e=new Array(u),f(),n=new Array(u),p()}}function f(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+c(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+l(t[e],e,t)}return null==t&&(t=[]),d.initialize=function(t,e){r=t,o=e,h()},d.links=function(e){return arguments.length?(t=e,h(),d):t},d.id=function(t){return arguments.length?(s=t,d):s},d.iterations=function(t){return arguments.length?(u=+t,d):u},d.strength=function(t){return arguments.length?(c="function"==typeof t?t:ir(+t),f(),d):c},d.distance=function(t){return arguments.length?(l="function"==typeof t?t:ir(+t),p(),d):l},d}().id(t=>t.id).distance(100).strength(.8)).force("charge",function(){var t,e,n,r,i,a=ir(-30),o=1,s=1/0,c=.81;function l(n){var i,a=t.length,o=tr(t,dr,hr).visitAfter(d);for(r=n,i=0;i<a;++i)e=t[i],o.visit(h)}function u(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+a(n,e,t)}}function d(t){var e,n,r,a,o,s=0,c=0;if(t.length){for(r=a=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,c+=n,r+=n*e.x,a+=n*e.y);t.x=r/c,t.y=a/c}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function h(t,a,l,u){if(!t.value)return!0;var d=t.x-e.x,h=t.y-e.y,f=u-a,p=d*d+h*h;if(f*f/c<p)return p<s&&(0===d&&(p+=(d=ar(n))*d),0===h&&(p+=(h=ar(n))*h),p<o&&(p=Math.sqrt(o*p)),e.vx+=d*t.value*r/p,e.vy+=h*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===d&&(p+=(d=ar(n))*d),0===h&&(p+=(h=ar(n))*h),p<o&&(p=Math.sqrt(o*p)));do{t.data!==e&&(f=i[t.data.index]*r/p,e.vx+=d*f,e.vy+=h*f)}while(t=t.next)}}return l.initialize=function(e,r){t=e,n=r,u()},l.strength=function(t){return arguments.length?(a="function"==typeof t?t:ir(+t),u(),l):a},l.distanceMin=function(t){return arguments.length?(o=t*t,l):Math.sqrt(o)},l.distanceMax=function(t){return arguments.length?(s=t*t,l):Math.sqrt(s)},l.theta=function(t){return arguments.length?(c=t*t,l):Math.sqrt(c)},l}().strength(-400)).force("center",Yn(this.width/2,this.height/2)).force("collision",function(t){var e,n,r,i=1,a=1;function o(){for(var t,o,c,l,u,d,h,f=e.length,p=0;p<a;++p)for(o=tr(e,or,sr).visitAfter(s),t=0;t<f;++t)c=e[t],d=n[c.index],h=d*d,l=c.x+c.vx,u=c.y+c.vy,o.visit(v);function v(t,e,n,a,o){var s=t.data,f=t.r,p=d+f;if(!s)return e>l+p||a<l-p||n>u+p||o<u-p;if(s.index>c.index){var v=l-s.x-s.vx,m=u-s.y-s.vy,g=v*v+m*m;g<p*p&&(0===v&&(g+=(v=ar(r))*v),0===m&&(g+=(m=ar(r))*m),g=(p-(g=Math.sqrt(g)))/g*i,c.vx+=(v*=g)*(p=(f*=f)/(h+f)),c.vy+=(m*=g)*p,s.vx-=v*(p=1-p),s.vy-=m*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function c(){if(e){var r,i,a=e.length;for(n=new Array(a),r=0;r<a;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=ir(null==t?1:+t)),o.initialize=function(t,n){e=t,r=n,c()},o.iterations=function(t){return arguments.length?(a=+t,o):a},o.strength=function(t){return arguments.length?(i=+t,o):i},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:ir(+e),c(),o):t},o}().radius(35)).force("x",pr(this.width/2).strength(.1)).force("y",vr(this.height/2).strength(.1))}async loadIPRelationships(t,e,n){try{console.log("Loading IP relationships for:",t),console.log("IP Data:",e),console.log("Relationships:",n),this.buildGraphData(t,e,n),this.renderGraph()}catch(t){console.error("Failed to load IP relationships:",t),this.showError("Failed to load IP relationships")}}buildGraphData(t,e,n){this.nodes=[],this.links=[],console.log("Building graph data for:",t),this.nodes.push({id:t,name:e.name||"Root IP",type:"root",owner:e.owner||"Unknown",revenue:e.revenue||0,derivatives:n.filter(t=>"derivative"===t.type).length}),n.forEach(e=>{const n=e.target!==t?e.target:e.source;n&&n!==t&&(this.nodes.find(t=>t.id===n)||this.nodes.push({id:n,name:e.name||`IP ${n.slice(0,8)}...`,type:"derivative"===e.type?"child":"parent",owner:e.owner||"Unknown",revenue:e.revenue||0,derivatives:e.derivatives||0}),this.links.push({source:e.source,target:e.target,type:e.type,strength:1,revenue:e.revenue||0}))}),console.log("Built nodes:",this.nodes),console.log("Built links:",this.links),1===this.nodes.length&&this.addDemoNodes(t)}addDemoNodes(t){const e="0x"+Math.random().toString(16).substr(2,40);this.nodes.push({id:e,name:"Parent IP Asset",type:"parent",owner:"0x1234...5678",revenue:150,derivatives:3}),this.links.push({source:e,target:t,type:"parent",strength:1,revenue:25});for(let e=0;e<3;e++){const n="0x"+Math.random().toString(16).substr(2,40);this.nodes.push({id:n,name:`Derivative ${e+1}`,type:"child",owner:`0xabcd...${e}${e}${e}${e}`,revenue:50*Math.random(),derivatives:Math.floor(3*Math.random())}),this.links.push({source:t,target:n,type:"derivative",strength:1,revenue:20*Math.random()})}}renderGraph(){const t=this.svg.select(".main-group");t.selectAll("*").remove(),console.log("Rendering graph with nodes:",this.nodes.length,"links:",this.links.length),this.linkElements=t.append("g").attr("class","links").selectAll("line").data(this.links).enter().append("line").attr("stroke",t=>this.getLinkColor(t.type)).attr("stroke-width",t=>this.calculateLinkWidth(t.revenue||0)).attr("stroke-opacity",.7).attr("marker-end","url(#arrowhead)"),this.nodeElements=t.append("g").attr("class","nodes").selectAll("g").data(this.nodes).enter().append("g").attr("class","node").style("cursor","pointer").call(function(){var t,e,n,r,i=Vn,a=Gn,o=Xn,s=Wn,c={},l=Dt("start","drag","end"),u=0,d=0;function h(t){t.on("mousedown.drag",f).filter(s).on("touchstart.drag",m).on("touchmove.drag",g,Ln).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(o,s){if(!r&&i.call(this,o,s)){var c=w(this,a.call(this,o,s),o,s,"mouse");c&&(On(o.view).on("mousemove.drag",p,Dn).on("mouseup.drag",v,Dn),Fn(o.view),Bn(o),n=!1,t=o.clientX,e=o.clientY,c("start",o))}}function p(r){if(jn(r),!n){var i=r.clientX-t,a=r.clientY-e;n=i*i+a*a>d}c.mouse("drag",r)}function v(t){On(t.view).on("mousemove.drag mouseup.drag",null),Un(t.view,n),jn(t),c.mouse("end",t)}function m(t,e){if(i.call(this,t,e)){var n,r,o=t.changedTouches,s=a.call(this,t,e),c=o.length;for(n=0;n<c;++n)(r=w(this,s,t,e,o[n].identifier,o[n]))&&(Bn(t),r("start",t,o[n]))}}function g(t){var e,n,r=t.changedTouches,i=r.length;for(e=0;e<i;++e)(n=c[r[e].identifier])&&(jn(t),n("drag",t,r[e]))}function y(t){var e,n,i=t.changedTouches,a=i.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),e=0;e<a;++e)(n=c[i[e].identifier])&&(Bn(t),n("end",t,i[e]))}function w(t,e,n,r,i,a){var s,d,f,p=l.copy(),v=zn(a||n,e);if(null!=(f=o.call(t,new Hn("beforestart",{sourceEvent:n,target:h,identifier:i,active:u,x:v[0],y:v[1],dx:0,dy:0,dispatch:p}),r)))return s=f.x-v[0]||0,d=f.y-v[1]||0,function n(a,o,l){var m,g=v;switch(a){case"start":c[i]=n,m=u++;break;case"end":delete c[i],--u;case"drag":v=zn(l||o,e),m=u}p.call(a,t,new Hn(a,{sourceEvent:o,subject:f,target:h,identifier:i,active:m,x:v[0]+s,y:v[1]+d,dx:v[0]-g[0],dy:v[1]-g[1],dispatch:p}),r)}}return h.filter=function(t){return arguments.length?(i="function"==typeof t?t:qn(!!t),h):i},h.container=function(t){return arguments.length?(a="function"==typeof t?t:qn(t),h):a},h.subject=function(t){return arguments.length?(o="function"==typeof t?t:qn(t),h):o},h.touchable=function(t){return arguments.length?(s="function"==typeof t?t:qn(!!t),h):s},h.on=function(){var t=l.on.apply(l,arguments);return t===l?h:t},h.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,h):Math.sqrt(d)},h}().on("start",(t,e)=>this.dragStarted(t,e)).on("drag",(t,e)=>this.dragged(t,e)).on("end",(t,e)=>this.dragEnded(t,e))),this.nodeElements.append("circle").attr("r",t=>this.getNodeRadius(t.type)).attr("fill",t=>this.getNodeColor(t.type)).attr("stroke","#fff").attr("stroke-width",3).style("filter","drop-shadow(0 2px 4px rgba(0,0,0,0.1))"),this.nodeElements.append("text").text(t=>t.name.length>15?t.name.substring(0,15)+"...":t.name).attr("x",0).attr("y",t=>this.getNodeRadius(t.type)+18).attr("text-anchor","middle").attr("font-size","11px").attr("font-weight","600").attr("fill","#333").style("pointer-events","none"),this.nodeElements.filter(t=>t.revenue&&t.revenue>0).append("text").text(t=>`$${t.revenue?.toFixed(1)}`).attr("x",0).attr("y",t=>this.getNodeRadius(t.type)+32).attr("text-anchor","middle").attr("font-size","9px").attr("font-weight","500").attr("fill","#10b981").style("pointer-events","none"),this.nodeElements.on("click",(t,e)=>{this.handleNodeClick(t,e)}),this.nodeElements.on("mouseenter",(t,e)=>{this.handleNodeHover(t,e,!0)}).on("mouseleave",(t,e)=>{this.handleNodeHover(t,e,!1)}),this.nodeElements.append("title").text(t=>`${t.name}\nOwner: ${t.owner.slice(0,10)}...\nType: ${t.type}\nRevenue: $${t.revenue||0}\nDerivatives: ${t.derivatives||0}`),this.simulation.nodes(this.nodes),this.simulation.force("link").links(this.links),this.simulation.on("tick",()=>{this.linkElements.attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y),this.nodeElements.attr("transform",t=>`translate(${t.x},${t.y})`)}),this.simulation.alpha(1).restart()}handleNodeClick(t,e){console.log("Node clicked:",e),this.highlightConnectedNodes(e.id);const n=new CustomEvent("nodeClick",{detail:{node:e,event:t}});this.container.dispatchEvent(n)}handleNodeHover(t,e,n){const r=On(t.currentTarget);n?r.select("circle").transition().duration(200).attr("r",1.2*this.getNodeRadius(e.type)).style("filter","drop-shadow(0 4px 8px rgba(0,0,0,0.2))"):r.select("circle").transition().duration(200).attr("r",this.getNodeRadius(e.type)).style("filter","drop-shadow(0 2px 4px rgba(0,0,0,0.1))")}highlightConnectedNodes(t){this.nodeElements.select("circle").attr("stroke-width",3).attr("stroke","#fff"),this.linkElements.attr("stroke-opacity",.3),this.nodeElements.filter(e=>e.id===t).select("circle").attr("stroke-width",4).attr("stroke","#ff6b6b");const e=this.links.filter(e=>e.source.id===t||e.target.id===t),n=new Set;e.forEach(t=>{n.add(t.source.id),n.add(t.target.id)}),this.nodeElements.filter(t=>n.has(t.id)).select("circle").attr("stroke-width",4).attr("stroke","#4ecdc4"),this.linkElements.filter(e=>e.source.id===t||e.target.id===t).attr("stroke-opacity",1)}getNodeColor(t){return{root:"url(#rootGradient)",parent:"url(#parentGradient)",child:"url(#childGradient)",derivative:"url(#derivativeGradient)"}[t]||"#6b7280"}getNodeRadius(t){return{root:22,parent:18,child:16,derivative:14}[t]||14}getLinkColor(t){return{parent:"#10b981",derivative:"#ef4444",license:"#3b82f6"}[t]||"#6b7280"}calculateLinkWidth(t=0){const e=Math.log10(t+1);return Math.min(8,1.5+2*e)}dragStarted(t,e){t.active||this.simulation.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}dragged(t,e){e.fx=t.x,e.fy=t.y}dragEnded(t,e){t.active||this.simulation.alphaTarget(0),e.fx=null,e.fy=null}showError(t){const e=this.svg.select(".main-group");e.selectAll("*").remove(),e.append("text").text(t).attr("x",this.width/2).attr("y",this.height/2).attr("text-anchor","middle").attr("font-size","14px").attr("fill","#ef4444")}showPlaceholder(){const t=this.svg.select(".main-group");t.selectAll("*").remove();const e=t.append("g").attr("class","placeholder").attr("transform",`translate(${this.width/2}, ${this.height/2})`);e.append("circle").attr("r",30).attr("fill","#f8f9fa").attr("stroke","#dee2e6").attr("stroke-width",2).attr("stroke-dasharray","5,5"),e.append("text").text("ðŸŽ¯").attr("text-anchor","middle").attr("font-size","24px").attr("y",8),e.append("text").text("Search for an IP Asset").attr("text-anchor","middle").attr("font-size","12px").attr("y",50).attr("fill","#6b7280"),e.append("text").text("to visualize relationships").attr("text-anchor","middle").attr("font-size","12px").attr("y",65).attr("fill","#6b7280")}clear(){this.nodes=[],this.links=[],this.simulation.nodes([]),this.simulation.force("link").links([]),this.showPlaceholder()}resize(){this.width=this.container.clientWidth||360,this.height=this.container.clientHeight||280,this.svg.attr("width",this.width).attr("height",this.height),this.simulation.force("center",Yn(this.width/2,this.height/2)).force("x",pr(this.width/2).strength(.1)).force("y",vr(this.height/2).strength(.1)).alpha(1).restart()}}function $r(t,e){return function(){return t.apply(e,arguments)}}const{toString:Nr}=Object.prototype,{getPrototypeOf:Mr}=Object,{iterator:Cr,toStringTag:Or}=Symbol,zr=(Lr=Object.create(null),t=>{const e=Nr.call(t);return Lr[e]||(Lr[e]=e.slice(8,-1).toLowerCase())});var Lr;const Dr=t=>(t=t.toLowerCase(),e=>zr(e)===t),Br=t=>e=>typeof e===t,{isArray:jr}=Array,Fr=Br("undefined");function Ur(t){return null!==t&&!Fr(t)&&null!==t.constructor&&!Fr(t.constructor)&&Vr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const qr=Dr("ArrayBuffer"),Hr=Br("string"),Vr=Br("function"),Gr=Br("number"),Xr=t=>null!==t&&"object"==typeof t,Wr=t=>{if("object"!==zr(t))return!1;const e=Mr(t);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||Or in t||Cr in t)},Yr=Dr("Date"),Jr=Dr("File"),Kr=Dr("Blob"),Qr=Dr("FileList"),Zr=Dr("URLSearchParams"),[ti,ei,ni,ri]=["ReadableStream","Request","Response","Headers"].map(Dr);function ii(t,e,{allOwnKeys:n=!1}={}){if(null==t)return;let r,i;if("object"!=typeof t&&(t=[t]),jr(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{if(Ur(t))return;const i=n?Object.getOwnPropertyNames(t):Object.keys(t),a=i.length;let o;for(r=0;r<a;r++)o=i[r],e.call(null,t[o],o,t)}}function ai(t,e){if(Ur(t))return null;e=e.toLowerCase();const n=Object.keys(t);let r,i=n.length;for(;i-- >0;)if(r=n[i],e===r.toLowerCase())return r;return null}const oi="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,si=t=>!Fr(t)&&t!==oi,ci=(li="undefined"!=typeof Uint8Array&&Mr(Uint8Array),t=>li&&t instanceof li);var li;const ui=Dr("HTMLFormElement"),di=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),hi=Dr("RegExp"),fi=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};ii(n,(n,i)=>{let a;!1!==(a=e(n,i,t))&&(r[i]=a||n)}),Object.defineProperties(t,r)},pi=Dr("AsyncFunction"),vi=(mi="function"==typeof setImmediate,gi=Vr(oi.postMessage),mi?setImmediate:gi?(yi=`axios@${Math.random()}`,wi=[],oi.addEventListener("message",({source:t,data:e})=>{t===oi&&e===yi&&wi.length&&wi.shift()()},!1),t=>{wi.push(t),oi.postMessage(yi,"*")}):t=>setTimeout(t));var mi,gi,yi,wi;const xi="undefined"!=typeof queueMicrotask?queueMicrotask.bind(oi):"undefined"!=typeof process&&process.nextTick||vi,bi={isArray:jr,isArrayBuffer:qr,isBuffer:Ur,isFormData:t=>{let e;return t&&("function"==typeof FormData&&t instanceof FormData||Vr(t.append)&&("formdata"===(e=zr(t))||"object"===e&&Vr(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&qr(t.buffer),e},isString:Hr,isNumber:Gr,isBoolean:t=>!0===t||!1===t,isObject:Xr,isPlainObject:Wr,isEmptyObject:t=>{if(!Xr(t)||Ur(t))return!1;try{return 0===Object.keys(t).length&&Object.getPrototypeOf(t)===Object.prototype}catch(t){return!1}},isReadableStream:ti,isRequest:ei,isResponse:ni,isHeaders:ri,isUndefined:Fr,isDate:Yr,isFile:Jr,isBlob:Kr,isRegExp:hi,isFunction:Vr,isStream:t=>Xr(t)&&Vr(t.pipe),isURLSearchParams:Zr,isTypedArray:ci,isFileList:Qr,forEach:ii,merge:function t(){const{caseless:e}=si(this)&&this||{},n={},r=(r,i)=>{const a=e&&ai(n,i)||i;Wr(n[a])&&Wr(r)?n[a]=t(n[a],r):Wr(r)?n[a]=t({},r):jr(r)?n[a]=r.slice():n[a]=r};for(let t=0,e=arguments.length;t<e;t++)arguments[t]&&ii(arguments[t],r);return n},extend:(t,e,n,{allOwnKeys:r}={})=>(ii(e,(e,r)=>{n&&Vr(e)?t[r]=$r(e,n):t[r]=e},{allOwnKeys:r}),t),trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},toFlatObject:(t,e,n,r)=>{let i,a,o;const s={};if(e=e||{},null==t)return e;do{for(i=Object.getOwnPropertyNames(t),a=i.length;a-- >0;)o=i[a],r&&!r(o,t,e)||s[o]||(e[o]=t[o],s[o]=!0);t=!1!==n&&Mr(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kindOf:zr,kindOfTest:Dr,endsWith:(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return-1!==r&&r===n},toArray:t=>{if(!t)return null;if(jr(t))return t;let e=t.length;if(!Gr(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},forEachEntry:(t,e)=>{const n=(t&&t[Cr]).call(t);let r;for(;(r=n.next())&&!r.done;){const n=r.value;e.call(t,n[0],n[1])}},matchAll:(t,e)=>{let n;const r=[];for(;null!==(n=t.exec(e));)r.push(n);return r},isHTMLForm:ui,hasOwnProperty:di,hasOwnProp:di,reduceDescriptors:fi,freezeMethods:t=>{fi(t,(e,n)=>{if(Vr(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=t[n];Vr(r)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(t,e)=>{const n={},r=t=>{t.forEach(t=>{n[t]=!0})};return jr(t)?r(t):r(String(t).split(e)),n},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,e,n){return e.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(t,e)=>null!=t&&Number.isFinite(t=+t)?t:e,findKey:ai,global:oi,isContextDefined:si,isSpecCompliantForm:function(t){return!!(t&&Vr(t.append)&&"FormData"===t[Or]&&t[Cr])},toJSONObject:t=>{const e=new Array(10),n=(t,r)=>{if(Xr(t)){if(e.indexOf(t)>=0)return;if(Ur(t))return t;if(!("toJSON"in t)){e[r]=t;const i=jr(t)?[]:{};return ii(t,(t,e)=>{const a=n(t,r+1);!Fr(a)&&(i[e]=a)}),e[r]=void 0,i}}return t};return n(t,0)},isAsyncFn:pi,isThenable:t=>t&&(Xr(t)||Vr(t))&&Vr(t.then)&&Vr(t.catch),setImmediate:vi,asap:xi,isIterable:t=>null!=t&&Vr(t[Cr])};function _i(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}bi.inherits(_i,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:bi.toJSONObject(this.config),code:this.code,status:this.status}}});const Ei=_i.prototype,ki={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{ki[t]={value:t}}),Object.defineProperties(_i,ki),Object.defineProperty(Ei,"isAxiosError",{value:!0}),_i.from=(t,e,n,r,i,a)=>{const o=Object.create(Ei);return bi.toFlatObject(t,o,function(t){return t!==Error.prototype},t=>"isAxiosError"!==t),_i.call(o,t.message,e,n,r,i),o.cause=t,o.name=t.name,a&&Object.assign(o,a),o};const Si=_i;function Ai(t){return bi.isPlainObject(t)||bi.isArray(t)}function Pi(t){return bi.endsWith(t,"[]")?t.slice(0,-2):t}function Ri(t,e,n){return t?t.concat(e).map(function(t,e){return t=Pi(t),!n&&e?"["+t+"]":t}).join(n?".":""):e}const Ti=bi.toFlatObject(bi,{},null,function(t){return/^is[A-Z]/.test(t)}),Ii=function(t,e,n){if(!bi.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const r=(n=bi.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(t,e){return!bi.isUndefined(e[t])})).metaTokens,i=n.visitor||l,a=n.dots,o=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&bi.isSpecCompliantForm(e);if(!bi.isFunction(i))throw new TypeError("visitor must be a function");function c(t){if(null===t)return"";if(bi.isDate(t))return t.toISOString();if(bi.isBoolean(t))return t.toString();if(!s&&bi.isBlob(t))throw new Si("Blob is not supported. Use a Buffer instead.");return bi.isArrayBuffer(t)||bi.isTypedArray(t)?s&&"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}function l(t,n,i){let s=t;if(t&&!i&&"object"==typeof t)if(bi.endsWith(n,"{}"))n=r?n:n.slice(0,-2),t=JSON.stringify(t);else if(bi.isArray(t)&&function(t){return bi.isArray(t)&&!t.some(Ai)}(t)||(bi.isFileList(t)||bi.endsWith(n,"[]"))&&(s=bi.toArray(t)))return n=Pi(n),s.forEach(function(t,r){!bi.isUndefined(t)&&null!==t&&e.append(!0===o?Ri([n],r,a):null===o?n:n+"[]",c(t))}),!1;return!!Ai(t)||(e.append(Ri(i,n,a),c(t)),!1)}const u=[],d=Object.assign(Ti,{defaultVisitor:l,convertValue:c,isVisitable:Ai});if(!bi.isObject(t))throw new TypeError("data must be an object");return function t(n,r){if(!bi.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),bi.forEach(n,function(n,a){!0===(!(bi.isUndefined(n)||null===n)&&i.call(e,n,bi.isString(a)?a.trim():a,r,d))&&t(n,r?r.concat(a):[a])}),u.pop()}}(t),e};function $i(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(t){return e[t]})}function Ni(t,e){this._pairs=[],t&&Ii(t,this,e)}const Mi=Ni.prototype;Mi.append=function(t,e){this._pairs.push([t,e])},Mi.toString=function(t){const e=t?function(e){return t.call(this,e,$i)}:$i;return this._pairs.map(function(t){return e(t[0])+"="+e(t[1])},"").join("&")};const Ci=Ni;function Oi(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function zi(t,e,n){if(!e)return t;const r=n&&n.encode||Oi;bi.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let a;if(a=i?i(e,n):bi.isURLSearchParams(e)?e.toString():new Ci(e,n).toString(r),a){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+a}return t}const Li=class{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){bi.forEach(this.handlers,function(e){null!==e&&t(e)})}},Di={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Bi={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Ci,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},ji="undefined"!=typeof window&&"undefined"!=typeof document,Fi="object"==typeof navigator&&navigator||void 0,Ui=ji&&(!Fi||["ReactNative","NativeScript","NS"].indexOf(Fi.product)<0),qi="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Hi=ji&&window.location.href||"http://localhost",Vi={...a,...Bi},Gi=function(t){function e(t,n,r,i){let a=t[i++];if("__proto__"===a)return!0;const o=Number.isFinite(+a),s=i>=t.length;return a=!a&&bi.isArray(r)?r.length:a,s?(bi.hasOwnProp(r,a)?r[a]=[r[a],n]:r[a]=n,!o):(r[a]&&bi.isObject(r[a])||(r[a]=[]),e(t,n,r[a],i)&&bi.isArray(r[a])&&(r[a]=function(t){const e={},n=Object.keys(t);let r;const i=n.length;let a;for(r=0;r<i;r++)a=n[r],e[a]=t[a];return e}(r[a])),!o)}if(bi.isFormData(t)&&bi.isFunction(t.entries)){const n={};return bi.forEachEntry(t,(t,r)=>{e(function(t){return bi.matchAll(/\w+|\[(\w*)]/g,t).map(t=>"[]"===t[0]?"":t[1]||t[0])}(t),r,n,0)}),n}return null},Xi={transitional:Di,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const n=e.getContentType()||"",r=n.indexOf("application/json")>-1,i=bi.isObject(t);if(i&&bi.isHTMLForm(t)&&(t=new FormData(t)),bi.isFormData(t))return r?JSON.stringify(Gi(t)):t;if(bi.isArrayBuffer(t)||bi.isBuffer(t)||bi.isStream(t)||bi.isFile(t)||bi.isBlob(t)||bi.isReadableStream(t))return t;if(bi.isArrayBufferView(t))return t.buffer;if(bi.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return Ii(t,new Vi.classes.URLSearchParams,{visitor:function(t,e,n,r){return Vi.isNode&&bi.isBuffer(t)?(this.append(e,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)},...e})}(t,this.formSerializer).toString();if((a=bi.isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return Ii(a?{"files[]":t}:t,e&&new e,this.formSerializer)}}return i||r?(e.setContentType("application/json",!1),function(t){if(bi.isString(t))try{return(0,JSON.parse)(t),bi.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(0,JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||Xi.transitional,n=e&&e.forcedJSONParsing,r="json"===this.responseType;if(bi.isResponse(t)||bi.isReadableStream(t))return t;if(t&&bi.isString(t)&&(n&&!this.responseType||r)){const n=!(e&&e.silentJSONParsing)&&r;try{return JSON.parse(t)}catch(t){if(n){if("SyntaxError"===t.name)throw Si.from(t,Si.ERR_BAD_RESPONSE,this,null,this.response);throw t}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Vi.classes.FormData,Blob:Vi.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};bi.forEach(["delete","get","head","post","put","patch"],t=>{Xi.headers[t]={}});const Wi=Xi,Yi=bi.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ji=Symbol("internals");function Ki(t){return t&&String(t).trim().toLowerCase()}function Qi(t){return!1===t||null==t?t:bi.isArray(t)?t.map(Qi):String(t)}function Zi(t,e,n,r,i){return bi.isFunction(r)?r.call(this,e,n):(i&&(e=n),bi.isString(e)?bi.isString(r)?-1!==e.indexOf(r):bi.isRegExp(r)?r.test(e):void 0:void 0)}class ta{constructor(t){t&&this.set(t)}set(t,e,n){const r=this;function i(t,e,n){const i=Ki(e);if(!i)throw new Error("header name must be a non-empty string");const a=bi.findKey(r,i);(!a||void 0===r[a]||!0===n||void 0===n&&!1!==r[a])&&(r[a||e]=Qi(t))}const a=(t,e)=>bi.forEach(t,(t,n)=>i(t,n,e));if(bi.isPlainObject(t)||t instanceof this.constructor)a(t,e);else if(bi.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))a((t=>{const e={};let n,r,i;return t&&t.split("\n").forEach(function(t){i=t.indexOf(":"),n=t.substring(0,i).trim().toLowerCase(),r=t.substring(i+1).trim(),!n||e[n]&&Yi[n]||("set-cookie"===n?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e})(t),e);else if(bi.isObject(t)&&bi.isIterable(t)){let n,r,i={};for(const e of t){if(!bi.isArray(e))throw TypeError("Object iterator must return a key-value pair");i[r=e[0]]=(n=i[r])?bi.isArray(n)?[...n,e[1]]:[n,e[1]]:e[1]}a(i,e)}else null!=t&&i(e,t,n);return this}get(t,e){if(t=Ki(t)){const n=bi.findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}(t);if(bi.isFunction(e))return e.call(this,t,n);if(bi.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=Ki(t)){const n=bi.findKey(this,t);return!(!n||void 0===this[n]||e&&!Zi(0,this[n],n,e))}return!1}delete(t,e){const n=this;let r=!1;function i(t){if(t=Ki(t)){const i=bi.findKey(n,t);!i||e&&!Zi(0,n[i],i,e)||(delete n[i],r=!0)}}return bi.isArray(t)?t.forEach(i):i(t),r}clear(t){const e=Object.keys(this);let n=e.length,r=!1;for(;n--;){const i=e[n];t&&!Zi(0,this[i],i,t,!0)||(delete this[i],r=!0)}return r}normalize(t){const e=this,n={};return bi.forEach(this,(r,i)=>{const a=bi.findKey(n,i);if(a)return e[a]=Qi(r),void delete e[i];const o=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,n)=>e.toUpperCase()+n)}(i):String(i).trim();o!==i&&delete e[i],e[o]=Qi(r),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return bi.forEach(this,(n,r)=>{null!=n&&!1!==n&&(e[r]=t&&bi.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const n=new this(t);return e.forEach(t=>n.set(t)),n}static accessor(t){const e=(this[Ji]=this[Ji]={accessors:{}}).accessors,n=this.prototype;function r(t){const r=Ki(t);e[r]||(function(t,e){const n=bi.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(t,n,i){return this[r].call(this,e,t,n,i)},configurable:!0})})}(n,t),e[r]=!0)}return bi.isArray(t)?t.forEach(r):r(t),this}}ta.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),bi.reduceDescriptors(ta.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(t){this[n]=t}}}),bi.freezeMethods(ta);const ea=ta;function na(t,e){const n=this||Wi,r=e||n,i=ea.from(r.headers);let a=r.data;return bi.forEach(t,function(t){a=t.call(n,a,i.normalize(),e?e.status:void 0)}),i.normalize(),a}function ra(t){return!(!t||!t.__CANCEL__)}function ia(t,e,n){Si.call(this,null==t?"canceled":t,Si.ERR_CANCELED,e,n),this.name="CanceledError"}bi.inherits(ia,Si,{__CANCEL__:!0});const aa=ia;function oa(t,e,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?e(new Si("Request failed with status code "+n.status,[Si.ERR_BAD_REQUEST,Si.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}const sa=(t,e,n=3)=>{let r=0;const i=function(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i,a=0,o=0;return e=void 0!==e?e:1e3,function(s){const c=Date.now(),l=r[o];i||(i=c),n[a]=s,r[a]=c;let u=o,d=0;for(;u!==a;)d+=n[u++],u%=t;if(a=(a+1)%t,a===o&&(o=(o+1)%t),c-i<e)return;const h=l&&c-l;return h?Math.round(1e3*d/h):void 0}}(50,250);return function(t,e){let n,r,i=0,a=1e3/e;const o=(e,a=Date.now())=>{i=a,n=null,r&&(clearTimeout(r),r=null),t(...e)};return[(...t)=>{const e=Date.now(),s=e-i;s>=a?o(t,e):(n=t,r||(r=setTimeout(()=>{r=null,o(n)},a-s)))},()=>n&&o(n)]}(n=>{const a=n.loaded,o=n.lengthComputable?n.total:void 0,s=a-r,c=i(s);r=a,t({loaded:a,total:o,progress:o?a/o:void 0,bytes:s,rate:c||void 0,estimated:c&&o&&a<=o?(o-a)/c:void 0,event:n,lengthComputable:null!=o,[e?"download":"upload"]:!0})},n)},ca=(t,e)=>{const n=null!=t;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},la=t=>(...e)=>bi.asap(()=>t(...e)),ua=Vi.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Vi.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Vi.origin),Vi.navigator&&/(msie|trident)/i.test(Vi.navigator.userAgent)):()=>!0,da=Vi.hasStandardBrowserEnv?{write(t,e,n,r,i,a){const o=[t+"="+encodeURIComponent(e)];bi.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),bi.isString(r)&&o.push("path="+r),bi.isString(i)&&o.push("domain="+i),!0===a&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function ha(t,e,n){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e);return t&&(r||0==n)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const fa=t=>t instanceof ea?{...t}:t;function pa(t,e){e=e||{};const n={};function r(t,e,n,r){return bi.isPlainObject(t)&&bi.isPlainObject(e)?bi.merge.call({caseless:r},t,e):bi.isPlainObject(e)?bi.merge({},e):bi.isArray(e)?e.slice():e}function i(t,e,n,i){return bi.isUndefined(e)?bi.isUndefined(t)?void 0:r(void 0,t,0,i):r(t,e,0,i)}function a(t,e){if(!bi.isUndefined(e))return r(void 0,e)}function o(t,e){return bi.isUndefined(e)?bi.isUndefined(t)?void 0:r(void 0,t):r(void 0,e)}function s(n,i,a){return a in e?r(n,i):a in t?r(void 0,n):void 0}const c={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(t,e,n)=>i(fa(t),fa(e),0,!0)};return bi.forEach(Object.keys({...t,...e}),function(r){const a=c[r]||i,o=a(t[r],e[r],r);bi.isUndefined(o)&&a!==s||(n[r]=o)}),n}const va=t=>{const e=pa({},t);let n,{data:r,withXSRFToken:i,xsrfHeaderName:a,xsrfCookieName:o,headers:s,auth:c}=e;if(e.headers=s=ea.from(s),e.url=zi(ha(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&s.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),bi.isFormData(r))if(Vi.hasStandardBrowserEnv||Vi.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(!1!==(n=s.getContentType())){const[t,...e]=n?n.split(";").map(t=>t.trim()).filter(Boolean):[];s.setContentType([t||"multipart/form-data",...e].join("; "))}if(Vi.hasStandardBrowserEnv&&(i&&bi.isFunction(i)&&(i=i(e)),i||!1!==i&&ua(e.url))){const t=a&&o&&da.read(o);t&&s.set(a,t)}return e},ma="undefined"!=typeof XMLHttpRequest&&function(t){return new Promise(function(e,n){const r=va(t);let i=r.data;const a=ea.from(r.headers).normalize();let o,s,c,l,u,{responseType:d,onUploadProgress:h,onDownloadProgress:f}=r;function p(){l&&l(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(o),r.signal&&r.signal.removeEventListener("abort",o)}let v=new XMLHttpRequest;function m(){if(!v)return;const r=ea.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders());oa(function(t){e(t),p()},function(t){n(t),p()},{data:d&&"text"!==d&&"json"!==d?v.response:v.responseText,status:v.status,statusText:v.statusText,headers:r,config:t,request:v}),v=null}v.open(r.method.toUpperCase(),r.url,!0),v.timeout=r.timeout,"onloadend"in v?v.onloadend=m:v.onreadystatechange=function(){v&&4===v.readyState&&(0!==v.status||v.responseURL&&0===v.responseURL.indexOf("file:"))&&setTimeout(m)},v.onabort=function(){v&&(n(new Si("Request aborted",Si.ECONNABORTED,t,v)),v=null)},v.onerror=function(){n(new Si("Network Error",Si.ERR_NETWORK,t,v)),v=null},v.ontimeout=function(){let e=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const i=r.transitional||Di;r.timeoutErrorMessage&&(e=r.timeoutErrorMessage),n(new Si(e,i.clarifyTimeoutError?Si.ETIMEDOUT:Si.ECONNABORTED,t,v)),v=null},void 0===i&&a.setContentType(null),"setRequestHeader"in v&&bi.forEach(a.toJSON(),function(t,e){v.setRequestHeader(e,t)}),bi.isUndefined(r.withCredentials)||(v.withCredentials=!!r.withCredentials),d&&"json"!==d&&(v.responseType=r.responseType),f&&([c,u]=sa(f,!0),v.addEventListener("progress",c)),h&&v.upload&&([s,l]=sa(h),v.upload.addEventListener("progress",s),v.upload.addEventListener("loadend",l)),(r.cancelToken||r.signal)&&(o=e=>{v&&(n(!e||e.type?new aa(null,t,v):e),v.abort(),v=null)},r.cancelToken&&r.cancelToken.subscribe(o),r.signal&&(r.signal.aborted?o():r.signal.addEventListener("abort",o)));const g=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(r.url);g&&-1===Vi.protocols.indexOf(g)?n(new Si("Unsupported protocol "+g+":",Si.ERR_BAD_REQUEST,t)):v.send(i||null)})},ga=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let n,r=new AbortController;const i=function(t){if(!n){n=!0,o();const e=t instanceof Error?t:this.reason;r.abort(e instanceof Si?e:new aa(e instanceof Error?e.message:e))}};let a=e&&setTimeout(()=>{a=null,i(new Si(`timeout ${e} of ms exceeded`,Si.ETIMEDOUT))},e);const o=()=>{t&&(a&&clearTimeout(a),a=null,t.forEach(t=>{t.unsubscribe?t.unsubscribe(i):t.removeEventListener("abort",i)}),t=null)};t.forEach(t=>t.addEventListener("abort",i));const{signal:s}=r;return s.unsubscribe=()=>bi.asap(o),s}},ya=function*(t,e){let n=t.byteLength;if(!e||n<e)return void(yield t);let r,i=0;for(;i<n;)r=i+e,yield t.slice(i,r),i=r},wa=(t,e,n,r)=>{const i=async function*(t,e){for await(const n of async function*(t){if(t[Symbol.asyncIterator])return void(yield*t);const e=t.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;yield n}}finally{await e.cancel()}}(t))yield*ya(n,e)}(t,e);let a,o=0,s=t=>{a||(a=!0,r&&r(t))};return new ReadableStream({async pull(t){try{const{done:e,value:r}=await i.next();if(e)return s(),void t.close();let a=r.byteLength;if(n){let t=o+=a;n(t)}t.enqueue(new Uint8Array(r))}catch(t){throw s(t),t}},cancel:t=>(s(t),i.return())},{highWaterMark:2})},xa="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,ba=xa&&"function"==typeof ReadableStream,_a=xa&&("function"==typeof TextEncoder?(Ea=new TextEncoder,t=>Ea.encode(t)):async t=>new Uint8Array(await new Response(t).arrayBuffer()));var Ea;const ka=(t,...e)=>{try{return!!t(...e)}catch(t){return!1}},Sa=ba&&ka(()=>{let t=!1;const e=new Request(Vi.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),Aa=ba&&ka(()=>bi.isReadableStream(new Response("").body)),Pa={stream:Aa&&(t=>t.body)};var Ra;xa&&(Ra=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Pa[t]&&(Pa[t]=bi.isFunction(Ra[t])?e=>e[t]():(e,n)=>{throw new Si(`Response type '${t}' is not supported`,Si.ERR_NOT_SUPPORT,n)})}));const Ta=xa&&(async t=>{let{url:e,method:n,data:r,signal:i,cancelToken:a,timeout:o,onDownloadProgress:s,onUploadProgress:c,responseType:l,headers:u,withCredentials:d="same-origin",fetchOptions:h}=va(t);l=l?(l+"").toLowerCase():"text";let f,p=ga([i,a&&a.toAbortSignal()],o);const v=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let m;try{if(c&&Sa&&"get"!==n&&"head"!==n&&0!==(m=await(async(t,e)=>{const n=bi.toFiniteNumber(t.getContentLength());return null==n?(async t=>{if(null==t)return 0;if(bi.isBlob(t))return t.size;if(bi.isSpecCompliantForm(t)){const e=new Request(Vi.origin,{method:"POST",body:t});return(await e.arrayBuffer()).byteLength}return bi.isArrayBufferView(t)||bi.isArrayBuffer(t)?t.byteLength:(bi.isURLSearchParams(t)&&(t+=""),bi.isString(t)?(await _a(t)).byteLength:void 0)})(e):n})(u,r))){let t,n=new Request(e,{method:"POST",body:r,duplex:"half"});if(bi.isFormData(r)&&(t=n.headers.get("content-type"))&&u.setContentType(t),n.body){const[t,e]=ca(m,sa(la(c)));r=wa(n.body,65536,t,e)}}bi.isString(d)||(d=d?"include":"omit");const i="credentials"in Request.prototype;f=new Request(e,{...h,signal:p,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:i?d:void 0});let a=await fetch(f,h);const o=Aa&&("stream"===l||"response"===l);if(Aa&&(s||o&&v)){const t={};["status","statusText","headers"].forEach(e=>{t[e]=a[e]});const e=bi.toFiniteNumber(a.headers.get("content-length")),[n,r]=s&&ca(e,sa(la(s),!0))||[];a=new Response(wa(a.body,65536,n,()=>{r&&r(),v&&v()}),t)}l=l||"text";let g=await Pa[bi.findKey(Pa,l)||"text"](a,t);return!o&&v&&v(),await new Promise((e,n)=>{oa(e,n,{data:g,headers:ea.from(a.headers),status:a.status,statusText:a.statusText,config:t,request:f})})}catch(e){if(v&&v(),e&&"TypeError"===e.name&&/Load failed|fetch/i.test(e.message))throw Object.assign(new Si("Network Error",Si.ERR_NETWORK,t,f),{cause:e.cause||e});throw Si.from(e,e&&e.code,t,f)}}),Ia={http:null,xhr:ma,fetch:Ta};bi.forEach(Ia,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(t){}Object.defineProperty(t,"adapterName",{value:e})}});const $a=t=>`- ${t}`,Na=t=>bi.isFunction(t)||null===t||!1===t,Ma=t=>{t=bi.isArray(t)?t:[t];const{length:e}=t;let n,r;const i={};for(let a=0;a<e;a++){let e;if(n=t[a],r=n,!Na(n)&&(r=Ia[(e=String(n)).toLowerCase()],void 0===r))throw new Si(`Unknown adapter '${e}'`);if(r)break;i[e||"#"+a]=r}if(!r){const t=Object.entries(i).map(([t,e])=>`adapter ${t} `+(!1===e?"is not supported by the environment":"is not available in the build"));let n=e?t.length>1?"since :\n"+t.map($a).join("\n"):" "+$a(t[0]):"as no adapter specified";throw new Si("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r};function Ca(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new aa(null,t)}function Oa(t){return Ca(t),t.headers=ea.from(t.headers),t.data=na.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Ma(t.adapter||Wi.adapter)(t).then(function(e){return Ca(t),e.data=na.call(t,t.transformResponse,e),e.headers=ea.from(e.headers),e},function(e){return ra(e)||(Ca(t),e&&e.response&&(e.response.data=na.call(t,t.transformResponse,e.response),e.response.headers=ea.from(e.response.headers))),Promise.reject(e)})}const za="1.11.0",La={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{La[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const Da={};La.transitional=function(t,e,n){function r(t,e){return"[Axios v"+za+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return(n,i,a)=>{if(!1===t)throw new Si(r(i," has been removed"+(e?" in "+e:"")),Si.ERR_DEPRECATED);return e&&!Da[i]&&(Da[i]=!0,console.warn(r(i," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,i,a)}},La.spelling=function(t){return(e,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};const Ba={assertOptions:function(t,e,n){if("object"!=typeof t)throw new Si("options must be an object",Si.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const a=r[i],o=e[a];if(o){const e=t[a],n=void 0===e||o(e,a,t);if(!0!==n)throw new Si("option "+a+" must be "+n,Si.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new Si("Unknown option "+a,Si.ERR_BAD_OPTION)}},validators:La},ja=Ba.validators;class Fa{constructor(t){this.defaults=t||{},this.interceptors={request:new Li,response:new Li}}async request(t,e){try{return await this._request(t,e)}catch(t){if(t instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const n=e.stack?e.stack.replace(/^.+\n/,""):"";try{t.stack?n&&!String(t.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(t.stack+="\n"+n):t.stack=n}catch(t){}}throw t}}_request(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},e=pa(this.defaults,e);const{transitional:n,paramsSerializer:r,headers:i}=e;void 0!==n&&Ba.assertOptions(n,{silentJSONParsing:ja.transitional(ja.boolean),forcedJSONParsing:ja.transitional(ja.boolean),clarifyTimeoutError:ja.transitional(ja.boolean)},!1),null!=r&&(bi.isFunction(r)?e.paramsSerializer={serialize:r}:Ba.assertOptions(r,{encode:ja.function,serialize:ja.function},!0)),void 0!==e.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Ba.assertOptions(e,{baseUrl:ja.spelling("baseURL"),withXsrfToken:ja.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let a=i&&bi.merge(i.common,i[e.method]);i&&bi.forEach(["delete","get","head","post","put","patch","common"],t=>{delete i[t]}),e.headers=ea.concat(a,i);const o=[];let s=!0;this.interceptors.request.forEach(function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(s=s&&t.synchronous,o.unshift(t.fulfilled,t.rejected))});const c=[];let l;this.interceptors.response.forEach(function(t){c.push(t.fulfilled,t.rejected)});let u,d=0;if(!s){const t=[Oa.bind(this),void 0];for(t.unshift(...o),t.push(...c),u=t.length,l=Promise.resolve(e);d<u;)l=l.then(t[d++],t[d++]);return l}u=o.length;let h=e;for(d=0;d<u;){const t=o[d++],e=o[d++];try{h=t(h)}catch(t){e.call(this,t);break}}try{l=Oa.call(this,h)}catch(t){return Promise.reject(t)}for(d=0,u=c.length;d<u;)l=l.then(c[d++],c[d++]);return l}getUri(t){return zi(ha((t=pa(this.defaults,t)).baseURL,t.url,t.allowAbsoluteUrls),t.params,t.paramsSerializer)}}bi.forEach(["delete","get","head","options"],function(t){Fa.prototype[t]=function(e,n){return this.request(pa(n||{},{method:t,url:e,data:(n||{}).data}))}}),bi.forEach(["post","put","patch"],function(t){function e(e){return function(n,r,i){return this.request(pa(i||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Fa.prototype[t]=e(),Fa.prototype[t+"Form"]=e(!0)});const Ua=Fa;class qa{constructor(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(t){e=t});const n=this;this.promise.then(t=>{if(!n._listeners)return;let e=n._listeners.length;for(;e-- >0;)n._listeners[e](t);n._listeners=null}),this.promise.then=t=>{let e;const r=new Promise(t=>{n.subscribe(t),e=t}).then(t);return r.cancel=function(){n.unsubscribe(e)},r},t(function(t,r,i){n.reason||(n.reason=new aa(t,r,i),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=e=>{t.abort(e)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new qa(function(e){t=e}),cancel:t}}}const Ha=qa,Va={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Va).forEach(([t,e])=>{Va[e]=t});const Ga=Va,Xa=function t(e){const n=new Ua(e),r=$r(Ua.prototype.request,n);return bi.extend(r,Ua.prototype,n,{allOwnKeys:!0}),bi.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return t(pa(e,n))},r}(Wi);Xa.Axios=Ua,Xa.CanceledError=aa,Xa.CancelToken=Ha,Xa.isCancel=ra,Xa.VERSION=za,Xa.toFormData=Ii,Xa.AxiosError=Si,Xa.Cancel=Xa.CanceledError,Xa.all=function(t){return Promise.all(t)},Xa.spread=function(t){return function(e){return t.apply(null,e)}},Xa.isAxiosError=function(t){return bi.isObject(t)&&!0===t.isAxiosError},Xa.mergeConfig=pa,Xa.AxiosHeaders=ea,Xa.formToJSON=t=>Gi(bi.isHTMLForm(t)?new FormData(t):t),Xa.getAdapter=Ma,Xa.HttpStatusCode=Ga,Xa.default=Xa;const Wa=Xa;class Ya{constructor(){this.apiBaseUrl="https://api.storyapis.com",this.rpcUrl="https://aeneid.storyrpc.io",this.apiHeaders={"X-CHAIN":"story-aeneid","X-API-Key":"MhBsxkU1z9fG6TofE59KqiiWV-YlYE8Q4awlLQehF3U","Content-Type":"application/json"}}async getIPAsset(t){try{console.log(`Fetching IP Asset: ${t}`);const e=[`${this.apiBaseUrl}/assets/${t}`,`${this.apiBaseUrl}/ip-assets/${t}`,`${this.apiBaseUrl}/v1/assets/${t}`,`${this.apiBaseUrl}/api/v1/ip-assets/${t}`];for(const n of e)try{console.log(`Trying endpoint: ${n}`);const e=await Wa.get(n,{headers:this.apiHeaders,timeout:1e4});console.log("API Response:",e.data);const r=e.data;return{id:r.id||t,name:r.name||r.metadata?.title||`IP Asset ${t.slice(0,8)}...`,owner:r.owner,type:r.type||"IP Asset",revenue:r.revenue||0,derivatives:r.derivatives||0,createdAt:r.createdAt,totalRevenue:r.totalRevenue||0,monthlyRevenue:r.monthlyRevenue||[],licenseTerms:r.licenseTerms||[],tags:r.tags||[],metadata:r.metadata}}catch(t){console.log(`Endpoint ${n} failed:`,t.response?.status);continue}throw new Error("All API endpoints failed")}catch(e){return console.error("Error fetching IP Asset from API:",e),this.getIPAssetFromBlockchain(t)}}async getIPAssetFromBlockchain(t){try{if(console.log(`Fetching from blockchain: ${t}`),"0x"===(await Wa.post(this.rpcUrl,{jsonrpc:"2.0",method:"eth_getCode",params:[t,"latest"],id:1})).data.result)throw new Error("Address is not a contract");const e=["0x06fdde03","0x95d89b41","0x8da5cb5b","0x01ffc9a7"],n={};for(const r of e)try{const e=await Wa.post(this.rpcUrl,{jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:r},"latest"],id:1});e.data.result&&"0x"!==e.data.result&&(n[r]=e.data.result)}catch(t){console.log(`Function call ${r} failed:`,t)}if(Object.keys(n).length>0)return{id:t,name:`IP Asset ${t.slice(0,8)}...`,owner:"Unknown",type:"IP Asset",revenue:0,derivatives:0,createdAt:(new Date).toISOString(),totalRevenue:0,monthlyRevenue:[],licenseTerms:[],tags:["blockchain","story-protocol"],metadata:{title:`IP Asset ${t.slice(0,8)}`,description:"IP Asset registered on Story Protocol",image:"https://via.placeholder.com/300x300?text=Story+IP",contractData:n}};throw new Error("No contract data found")}catch(e){throw console.error("Error fetching from blockchain:",e),new Error(`Failed to fetch IP Asset ${t} - Asset may not exist or is not accessible`)}}async getIPRelationships(t){try{const e=[`${this.apiBaseUrl}/assets/${t}/relationships`,`${this.apiBaseUrl}/ip-assets/${t}/relationships`,`${this.apiBaseUrl}/v1/assets/${t}/relationships`];for(const t of e)try{return(await Wa.get(t,{headers:this.apiHeaders,timeout:1e4})).data.map(t=>({type:t.type,source:t.source,target:t.target,name:t.name,owner:t.owner,revenue:t.revenue,derivatives:t.derivatives,licenseType:t.licenseType,royaltyRate:t.royaltyRate,createdAt:t.createdAt}))}catch(t){continue}throw new Error("All relationship endpoints failed")}catch(t){return console.error("Error fetching IP relationships:",t),[]}}async getRandomIP(){try{console.log("Fetching IP addresses from Story Explorer web page...");const t=await fetch("https://aeneid.explorer.story.foundation/ipa",{method:"GET",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36","Accept-Language":"en-US,en;q=0.5","Accept-Encoding":"gzip, deflate, br",DNT:"1",Connection:"keep-alive","Upgrade-Insecure-Requests":"1","Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","Cache-Control":"max-age=0"}});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const e=await t.text();console.log("HTML received, length:",e.length),console.log("HTML preview (first 2000 chars):",e.substring(0,2e3));const n=this.extractAddressesFromStoryExplorer(e);if(0===n.length){const t=this.extractFromScriptTags(e);t.length>0&&n.push(...t)}if(0===n.length){const t=this.extractAnyHexPatterns(e);t.length>0&&n.push(...t)}if(0===n.length)throw console.error("No addresses found. HTML structure might be different."),console.log("Full HTML content:",e),new Error("No IP addresses found on the Story Explorer page");console.log(`Found ${n.length} IP addresses:`,n);const r=n[Math.floor(Math.random()*n.length)];return console.log("Selected random IP address:",r),r}catch(t){throw console.error("Error fetching from Story Explorer:",t),new Error(`Failed to fetch IP addresses from Story Explorer: ${t.message}`)}}extractAddressesFromStoryExplorer(t){const e=new Set;console.log("Extracting addresses using Story Explorer specific patterns...");const n=/<tr[^>]*>.*?<td[^>]*>.*?(0x[a-fA-F0-9]{40}).*?<\/td>.*?<\/tr>/gs;let r;for(;null!==(r=n.exec(t));){const t=r[1];this.isValidIPAddress(t)&&(e.add(t),console.log("Found address in table row:",t))}const i=/<a[^>]*href="[^"]*\/ipa\/([0x[a-fA-F0-9]{40})"[^>]*>/g;for(;null!==(r=i.exec(t));){const t=r[1];this.isValidIPAddress(t)&&(e.add(t),console.log("Found address in link:",t))}const a=/<div[^>]*(?:class="[^"]*address[^"]*"|data-address="([^"]*)").*?>(.*?0x[a-fA-F0-9]{40}.*?)<\/div>/gs;for(;null!==(r=a.exec(t));){const t=r[1],n=r[2];t&&this.isValidIPAddress(t)&&(e.add(t),console.log("Found address in div attribute:",t));const i=n.match(/0x[a-fA-F0-9]{40}/);i&&this.isValidIPAddress(i[0])&&(e.add(i[0]),console.log("Found address in div content:",i[0]))}const o=/<[^>]*>(.*?0x[a-fA-F0-9]{40}.*?)<\/[^>]*>/g;for(;null!==(r=o.exec(t));){const t=r[1].match(/0x[a-fA-F0-9]{40}/);t&&this.isValidIPAddress(t[0])&&(e.add(t[0]),console.log("Found address in general element:",t[0]))}return Array.from(e)}extractFromScriptTags(t){const e=new Set;console.log("Extracting addresses from script tags...");const n=/<script[^>]*>(.*?)<\/script>/gs;let r;for(;null!==(r=n.exec(t));){const t=r[1],n=/['"`](0x[a-fA-F0-9]{40})['"`]/g;let i;for(;null!==(i=n.exec(t));){const t=i[1];this.isValidIPAddress(t)&&(e.add(t),console.log("Found address in script:",t))}const a=/"(?:address|id|ipId|contractAddress)":\s*"(0x[a-fA-F0-9]{40})"/g;for(;null!==(i=a.exec(t));){const t=i[1];this.isValidIPAddress(t)&&(e.add(t),console.log("Found address in JSON structure:",t))}}return Array.from(e)}extractAnyHexPatterns(t){const e=new Set;console.log("Extracting any hex patterns that look like addresses...");const n=t.replace(/<[^>]*>/g," ").match(/0x[a-fA-F0-9]{40}/g);return n&&n.forEach(t=>{this.isValidIPAddress(t)&&(e.add(t),console.log("Found address in plain text:",t))}),Array.from(e)}isValidIPAddress(t){return!!/^0x[a-fA-F0-9]{40}$/i.test(t)&&!["0x0000000000000000000000000000000000000000","0x000000000000000000000000000000000000dead","0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"].includes(t.toLowerCase())}async getRevenueData(t){try{const e=[`${this.apiBaseUrl}/assets/${t}/revenue`,`${this.apiBaseUrl}/ip-assets/${t}/revenue`,`${this.apiBaseUrl}/v1/assets/${t}/revenue`];for(const t of e)try{const e=(await Wa.get(t,{headers:this.apiHeaders,timeout:1e4})).data;return{totalRevenue:e.totalRevenue||0,monthlyRevenue:e.monthlyRevenue||[],topEarningDerivatives:e.topEarningDerivatives||[],revenueBreakdown:e.revenueBreakdown||{directSales:0,royalties:0,licensing:0}}}catch(t){continue}throw new Error("All revenue endpoints failed")}catch(t){return console.error("Error fetching revenue data:",t),{totalRevenue:0,monthlyRevenue:[],topEarningDerivatives:[],revenueBreakdown:{directSales:0,royalties:0,licensing:0}}}}async searchIPAssets(t){try{const e=[`${this.apiBaseUrl}/assets/search`,`${this.apiBaseUrl}/ip-assets/search`,`${this.apiBaseUrl}/search/assets`];for(const n of e)try{return(await Wa.get(n,{headers:this.apiHeaders,params:{q:t,limit:10},timeout:1e4})).data.map(t=>({id:t.id,name:t.name||t.metadata?.title,owner:t.owner,type:t.type,revenue:t.revenue||0,derivatives:t.derivatives||0,totalRevenue:t.totalRevenue||0,tags:t.tags||[],metadata:t.metadata}))}catch(t){continue}return[]}catch(t){return console.error("Error searching IP assets:",t),[]}}async getIPAnalytics(t){try{const[e,n]=await Promise.all([this.getRevenueData(t),this.getIPRelationships(t)]);return{totalRevenue:e.totalRevenue,totalDerivatives:n.filter(t=>"derivative"===t.type).length,monthlyRevenue:e.monthlyRevenue,topDerivatives:e.topEarningDerivatives,revenueGrowth:this.calculateRevenueGrowth(e.monthlyRevenue),licenseTypes:n.map(t=>t.licenseType).filter(Boolean),averageRoyaltyRate:n.reduce((t,e)=>t+(e.royaltyRate||0),0)/n.length,creationTrend:this.generateCreationTrend(n)}}catch(t){throw console.error("Error fetching IP analytics:",t),t}}calculateRevenueGrowth(t){if(t.length<2)return 0;const e=t.slice(-3).reduce((t,e)=>t+e,0)/3,n=t.slice(-6,-3).reduce((t,e)=>t+e,0)/3;return n>0?(e-n)/n*100:0}generateCreationTrend(t){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(t=>({month:t,count:Math.floor(5*Math.random())}))}isValidIPId(t){return/^0x[a-fA-F0-9]{40}$/.test(t)}getNetworkInfo(){return{name:"Story Aeneid Testnet",chainId:"1315",explorer:"https://aeneid.storyscan.io"}}async getEcosystemOverview(){try{return(await Wa.get(`${this.apiBaseUrl}/ecosystem/overview`,{headers:this.apiHeaders,timeout:1e4})).data}catch(t){return console.error("Error fetching ecosystem overview:",t),{totalIPs:0,totalRevenue:0,totalDerivatives:0,topPerformers:[],recentActivity:[]}}}}class Ja{constructor(t){this.charts=new Map,this.container=t,this.data=this.initializeAnalyticsData(),this.setupEventListeners()}initializeAnalyticsData(){const t=localStorage.getItem("ip-graph-analytics");return t?JSON.parse(t):{totalIPs:0,totalRelationships:0,avgDerivatives:0,totalRevenue:0,searchCount:0,visualizationCount:0,topSearchedIPs:[],performanceMetrics:{avgLoadTime:0,successRate:100,errorRate:0},usageStats:{dailyActive:1,weeklyActive:1,totalSessions:1,avgSessionDuration:0},networkStats:{mostConnectedIP:{id:"",name:"",connections:0},largestNetwork:{rootId:"",nodeCount:0,depth:0},averageNetworkSize:0},revenueAnalytics:{totalEcosystemRevenue:0,averageIPRevenue:0,topRevenueGenerators:[],revenueDistribution:{original:0,derivatives:0,licenses:0}},timeSeriesData:{searchActivity:this.generateMockTimeSeriesData("search"),revenueGrowth:this.generateMockTimeSeriesData("revenue"),networkGrowth:this.generateMockTimeSeriesData("network")}}}generateMockTimeSeriesData(t){const e=[],n=new Date;for(let r=29;r>=0;r--){const i=new Date(n.getTime()-24*r*60*60*1e3);switch(t){case"search":e.push({date:i.toISOString().split("T")[0],searches:Math.floor(20*Math.random())+5,visualizations:Math.floor(15*Math.random())+3});break;case"revenue":e.push({month:i.toLocaleDateString("en",{month:"short"}),revenue:1e3*Math.random()+500,growth:20*(Math.random()-.5)});break;case"network":e.push({month:i.toLocaleDateString("en",{month:"short"}),newIPs:Math.floor(10*Math.random())+2,newRelationships:Math.floor(25*Math.random())+5})}}return e}render(){this.container.innerHTML=`\n      <div class="analytics-dashboard">\n        ${this.renderOverviewCards()}\n        ${this.renderPerformanceMetrics()}\n        ${this.renderUsageStatistics()}\n        ${this.renderNetworkAnalytics()}\n        ${this.renderRevenueAnalytics()}\n        ${this.renderTimeSeriesCharts()}\n        ${this.renderTopSearchedIPs()}\n      </div>\n    `,this.addStyles(),this.initializeCharts()}renderOverviewCards(){return`\n      <div class="overview-cards">\n        <div class="analytics-card primary">\n          <div class="card-icon">ðŸ“Š</div>\n          <div class="card-content">\n            <div class="card-value">${this.data.totalIPs.toLocaleString()}</div>\n            <div class="card-label">Total IPs Analyzed</div>\n            <div class="card-change positive">+${Math.floor(20*Math.random())}% this week</div>\n          </div>\n        </div>\n        \n        <div class="analytics-card secondary">\n          <div class="card-icon">ðŸ”—</div>\n          <div class="card-content">\n            <div class="card-value">${this.data.totalRelationships.toLocaleString()}</div>\n            <div class="card-label">Relationships Found</div>\n            <div class="card-change positive">+${Math.floor(15*Math.random())}% this week</div>\n          </div>\n        </div>\n        \n        <div class="analytics-card success">\n          <div class="card-icon">ðŸ’°</div>\n          <div class="card-content">\n            <div class="card-value">$${this.data.totalRevenue.toLocaleString()}</div>\n            <div class="card-label">Total Revenue Tracked</div>\n            <div class="card-change positive">+${Math.floor(25*Math.random())}% this month</div>\n          </div>\n        </div>\n        \n        <div class="analytics-card info">\n          <div class="card-icon">ðŸ”</div>\n          <div class="card-content">\n            <div class="card-value">${this.data.searchCount.toLocaleString()}</div>\n            <div class="card-label">Total Searches</div>\n            <div class="card-change neutral">${this.data.avgDerivatives.toFixed(1)} avg derivatives</div>\n          </div>\n        </div>\n      </div>\n    `}renderPerformanceMetrics(){const t=this.data.performanceMetrics?.avgLoadTime||0,e=this.data.performanceMetrics?.successRate||0,n=this.data.performanceMetrics?.errorRate||0;return`\n    <div class="performance-section">\n      <h3>âš¡ Performance Metrics</h3>\n      <div class="metrics-grid">\n        <div class="metric-item">\n          <div class="metric-label">Average Load Time</div>\n          <div class="metric-value">${t.toFixed(2)}s</div>\n          <div class="metric-bar">\n            <div class="metric-fill" style="width: ${Math.min(20*t,100)}%"></div>\n          </div>\n        </div>\n        \n        <div class="metric-item">\n          <div class="metric-label">Success Rate</div>\n          <div class="metric-value">${e.toFixed(1)}%</div>\n          <div class="metric-bar">\n            <div class="metric-fill success" style="width: ${Math.max(0,Math.min(e,100))}%"></div>\n          </div>\n        </div>\n        \n        <div class="metric-item">\n          <div class="metric-label">Error Rate</div>\n          <div class="metric-value">${n.toFixed(1)}%</div>\n          <div class="metric-bar">\n            <div class="metric-fill error" style="width: ${Math.max(0,Math.min(n,100))}%"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n  `}renderUsageStatistics(){return`\n      <div class="usage-section">\n        <h3>ðŸ‘¥ Usage Statistics</h3>\n        <div class="usage-stats">\n          <div class="usage-stat">\n            <div class="stat-icon">ðŸ“…</div>\n            <div class="stat-content">\n              <div class="stat-value">${this.data.usageStats.dailyActive}</div>\n              <div class="stat-label">Daily Active</div>\n            </div>\n          </div>\n          \n          <div class="usage-stat">\n            <div class="stat-icon">ðŸ“Š</div>\n            <div class="stat-content">\n              <div class="stat-value">${this.data.usageStats.totalSessions}</div>\n              <div class="stat-label">Total Sessions</div>\n            </div>\n          </div>\n          \n          <div class="usage-stat">\n            <div class="stat-icon">â±ï¸</div>\n            <div class="stat-content">\n              <div class="stat-value">${Math.floor(this.data.usageStats.avgSessionDuration/60)}m</div>\n              <div class="stat-label">Avg Session</div>\n            </div>\n          </div>\n          \n          <div class="usage-stat">\n            <div class="stat-icon">ðŸŽ¯</div>\n            <div class="stat-content">\n              <div class="stat-value">${this.data.visualizationCount}</div>\n              <div class="stat-label">Visualizations</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `}renderNetworkAnalytics(){const t=this.data.networkStats,e=t.averageNetworkSize||0;return`\n    <div class="network-section">\n      <h3>ðŸŒ Network Analytics</h3>\n      <div class="network-stats">\n        <div class="network-stat-card">\n          <h4>Most Connected IP</h4>\n          <div class="network-detail">\n            <div class="ip-name">${t.mostConnectedIP.name||"Digital Art Masterpiece"}</div>\n            <div class="ip-id">${t.mostConnectedIP.id||"0x1234...7890"}</div>\n            <div class="connection-count">${t.mostConnectedIP.connections||8} connections</div>\n          </div>\n        </div>\n        \n        <div class="network-stat-card">\n          <h4>Largest Network</h4>\n          <div class="network-detail">\n            <div class="network-size">${t.largestNetwork.nodeCount||12} nodes</div>\n            <div class="network-depth">Depth: ${t.largestNetwork.depth||4} levels</div>\n            <div class="network-root">Root: ${(t.largestNetwork.rootId||"0x4567...0123").slice(0,10)}...</div>\n          </div>\n        </div>\n        \n        <div class="network-stat-card">\n          <h4>Average Network Size</h4>\n          <div class="network-detail">\n            <div class="avg-size">${e.toFixed(1)} nodes</div>\n            <div class="network-trend">ðŸ“ˆ Growing</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  `}renderRevenueAnalytics(){const t=this.data.revenueAnalytics;return`\n      <div class="revenue-section">\n        <h3>ðŸ’Ž Revenue Analytics</h3>\n        <div class="revenue-overview">\n          <div class="revenue-total">\n            <div class="total-amount">$${t.totalEcosystemRevenue.toLocaleString()||"24,580"}</div>\n            <div class="total-label">Total Ecosystem Revenue</div>\n          </div>\n          \n          <div class="revenue-distribution">\n            <div class="distribution-item">\n              <span class="dist-label">Original Works</span>\n              <span class="dist-value">$${t.revenueDistribution.original.toLocaleString()||"15,200"}</span>\n              <div class="dist-bar">\n                <div class="dist-fill original" style="width: ${t.revenueDistribution.original/t.totalEcosystemRevenue*100||62}%"></div>\n              </div>\n            </div>\n            \n            <div class="distribution-item">\n              <span class="dist-label">Derivatives</span>\n              <span class="dist-value">$${t.revenueDistribution.derivatives.toLocaleString()||"7,380"}</span>\n              <div class="dist-bar">\n                <div class="dist-fill derivative" style="width: ${t.revenueDistribution.derivatives/t.totalEcosystemRevenue*100||30}%"></div>\n              </div>\n            </div>\n            \n            <div class="distribution-item">\n              <span class="dist-label">Licenses</span>\n              <span class="dist-value">$${t.revenueDistribution.licenses.toLocaleString()||"2,000"}</span>\n              <div class="dist-bar">\n                <div class="dist-fill license" style="width: ${t.revenueDistribution.licenses/t.totalEcosystemRevenue*100||8}%"></div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `}renderTimeSeriesCharts(){return'\n      <div class="charts-section">\n        <h3>ðŸ“ˆ Activity Trends</h3>\n        <div class="charts-container">\n          <div class="chart-card">\n            <h4>Search Activity (Last 30 Days)</h4>\n            <div id="search-activity-chart" class="chart-placeholder">\n              <div class="chart-loading">Loading chart...</div>\n            </div>\n          </div>\n          \n          <div class="chart-card">\n            <h4>Network Growth</h4>\n            <div id="network-growth-chart" class="chart-placeholder">\n              <div class="chart-loading">Loading chart...</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    '}renderTopSearchedIPs(){return`\n      <div class="top-searches-section">\n        <h3>ðŸ”¥ Most Searched IPs</h3>\n        <div class="top-searches-list">\n          ${(this.data.topSearchedIPs.length>0?this.data.topSearchedIPs:[{id:"0x1234567890123456789012345678901234567890",name:"Digital Art Masterpiece",searchCount:15,lastSearched:"2024-08-05T10:30:00Z"},{id:"0x4567890123456789012345678901234567890123",name:"NFT Collection Genesis",searchCount:12,lastSearched:"2024-08-05T09:15:00Z"},{id:"0x6789012345678901234567890123456789012345",name:"AI Generated Art Series",searchCount:8,lastSearched:"2024-08-05T08:45:00Z"}]).map((t,e)=>`\n            <div class="search-item" data-ip-id="${t.id}">\n              <div class="search-rank">#${e+1}</div>\n              <div class="search-details">\n                <div class="search-name">${t.name}</div>\n                <div class="search-id">${t.id.slice(0,10)}...${t.id.slice(-8)}</div>\n                <div class="search-meta">\n                  <span class="search-count">${t.searchCount} searches</span>\n                  <span class="last-searched">Last: ${new Date(t.lastSearched).toLocaleDateString()}</span>\n                </div>\n              </div>\n              <div class="search-actions">\n                <button class="search-again-btn" data-ip-id="${t.id}">ðŸ”</button>\n              </div>\n            </div>\n          `).join("")}\n        </div>\n      </div>\n    `}initializeCharts(){this.renderSearchActivityChart(),this.renderNetworkGrowthChart()}renderSearchActivityChart(){const t=document.getElementById("search-activity-chart");if(!t)return;const e=this.data.timeSeriesData.searchActivity.slice(-7),n=Math.max(...e.map(t=>Math.max(t.searches,t.visualizations)));t.innerHTML=`\n      <div class="simple-chart">\n        ${e.map((t,e)=>`\n          <div class="chart-day">\n            <div class="chart-bars">\n              <div class="chart-bar searches" style="height: ${t.searches/n*100}%" title="Searches: ${t.searches}"></div>\n              <div class="chart-bar visualizations" style="height: ${t.visualizations/n*100}%" title="Visualizations: ${t.visualizations}"></div>\n            </div>\n            <div class="chart-label">${new Date(t.date).toLocaleDateString("en",{weekday:"short"})}</div>\n          </div>\n        `).join("")}\n      </div>\n      <div class="chart-legend">\n        <div class="legend-item">\n          <div class="legend-color searches"></div>\n          <span>Searches</span>\n        </div>\n        <div class="legend-item">\n          <div class="legend-color visualizations"></div>\n          <span>Visualizations</span>\n        </div>\n      </div>\n    `}renderNetworkGrowthChart(){const t=document.getElementById("network-growth-chart");if(!t)return;const e=this.data.timeSeriesData.networkGrowth.slice(-6),n=Math.max(...e.map(t=>Math.max(t.newIPs,t.newRelationships)));t.innerHTML=`\n      <div class="simple-chart">\n        ${e.map((t,e)=>`\n          <div class="chart-month">\n            <div class="chart-bars">\n              <div class="chart-bar new-ips" style="height: ${t.newIPs/n*100}%" title="New IPs: ${t.newIPs}"></div>\n              <div class="chart-bar new-relationships" style="height: ${t.newRelationships/n*100}%" title="New Relationships: ${t.newRelationships}"></div>\n            </div>\n            <div class="chart-label">${t.month}</div>\n          </div>\n        `).join("")}\n      </div>\n      <div class="chart-legend">\n        <div class="legend-item">\n          <div class="legend-color new-ips"></div>\n          <span>New IPs</span>\n        </div>\n        <div class="legend-item">\n          <div class="legend-color new-relationships"></div>\n          <span>New Relationships</span>\n        </div>\n      </div>\n    `}setupEventListeners(){document.addEventListener("click",t=>{const e=t.target;if(e.classList.contains("search-again-btn")){const t=e.getAttribute("data-ip-id");t&&this.handleSearchAgain(t)}})}handleSearchAgain(t){const e=new CustomEvent("searchIP",{detail:{ipId:t}});document.dispatchEvent(e)}trackSearch(t,e){this.data.searchCount++,this.data.totalIPs++;const n=this.data.topSearchedIPs.findIndex(e=>e.id===t);n>=0?(this.data.topSearchedIPs[n].searchCount++,this.data.topSearchedIPs[n].lastSearched=(new Date).toISOString()):this.data.topSearchedIPs.push({id:t,name:e,searchCount:1,lastSearched:(new Date).toISOString()}),this.data.topSearchedIPs.sort((t,e)=>e.searchCount-t.searchCount),this.data.topSearchedIPs=this.data.topSearchedIPs.slice(0,10),this.saveData()}trackVisualization(t){this.data.visualizationCount++,this.data.totalRelationships+=t,this.data.avgDerivatives=this.data.totalRelationships/this.data.totalIPs,this.saveData()}trackPerformance(t,e){const n=this.data.performanceMetrics.avgLoadTime,r=this.data.searchCount;this.data.performanceMetrics.avgLoadTime=(n*(r-1)+t)/r,e?this.data.performanceMetrics.successRate=(this.data.performanceMetrics.successRate*(r-1)+100)/r:this.data.performanceMetrics.errorRate=(this.data.performanceMetrics.errorRate*(r-1)+100)/r,this.saveData()}updateRevenue(t){this.data.totalRevenue+=t,this.data.revenueAnalytics.totalEcosystemRevenue+=t,this.data.revenueAnalytics.averageIPRevenue=this.data.revenueAnalytics.totalEcosystemRevenue/this.data.totalIPs,this.saveData()}saveData(){localStorage.setItem("ip-graph-analytics",JSON.stringify(this.data))}exportData(){return JSON.stringify(this.data,null,2)}clearData(){localStorage.removeItem("ip-graph-analytics"),this.data=this.initializeAnalyticsData(),this.render()}addStyles(){if(document.getElementById("analytics-dashboard-styles"))return;const t=document.createElement("style");t.id="analytics-dashboard-styles",t.textContent="\n      .analytics-dashboard {\n        padding: 20px;\n        background: #f8f9fa;\n        border-radius: 12px;\n        margin: 15px 0;\n      }\n\n      .overview-cards {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n        gap: 15px;\n        margin-bottom: 25px;\n      }\n\n      .analytics-card {\n        background: white;\n        border-radius: 12px;\n        padding: 20px;\n        display: flex;\n        align-items: center;\n        gap: 15px;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n        transition: transform 0.2s ease;\n      }\n\n      .analytics-card:hover {\n        transform: translateY(-2px);\n      }\n\n      .analytics-card.primary { border-left: 4px solid #667eea; }\n      .analytics-card.secondary { border-left: 4px solid #764ba2; }\n      .analytics-card.success { border-left: 4px solid #10b981; }\n      .analytics-card.info { border-left: 4px solid #3b82f6; }\n\n      .card-icon {\n        font-size: 24px;\n        opacity: 0.8;\n      }\n\n      .card-content {\n        flex: 1;\n      }\n\n      .card-value {\n        font-size: 24px;\n        font-weight: bold;\n        color: #333;\n        margin-bottom: 4px;\n      }\n\n      .card-label {\n        font-size: 12px;\n        color: #666;\n        margin-bottom: 4px;\n      }\n\n      .card-change {\n        font-size: 11px;\n        font-weight: 600;\n      }\n\n      .card-change.positive { color: #10b981; }\n      .card-change.negative { color: #ef4444; }\n      .card-change.neutral { color: #6b7280; }\n\n      .performance-section,\n      .usage-section,\n      .network-section,\n      .revenue-section,\n      .charts-section,\n      .top-searches-section {\n        background: white;\n        border-radius: 12px;\n        padding: 20px;\n        margin-bottom: 20px;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n      }\n\n      .performance-section h3,\n      .usage-section h3,\n      .network-section h3,\n      .revenue-section h3,\n      .charts-section h3,\n      .top-searches-section h3 {\n        margin: 0 0 20px 0;\n        color: #333;\n        font-size: 16px;\n      }\n\n      .metrics-grid {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n        gap: 15px;\n      }\n\n      .metric-item {\n        padding: 15px;\n        background: #f8f9fa;\n        border-radius: 8px;\n      }\n\n      .metric-label {\n        font-size: 12px;\n        color: #666;\n        margin-bottom: 8px;\n      }\n\n      .metric-value {\n        font-size: 18px;\n        font-weight: bold;\n        color: #333;\n        margin-bottom: 10px;\n      }\n\n      .metric-bar {\n        height: 6px;\n        background: #e5e7eb;\n        border-radius: 3px;\n        overflow: hidden;\n      }\n\n      .metric-fill {\n        height: 100%;\n        background: #667eea;\n        transition: width 0.3s ease;\n      }\n\n      .metric-fill.success { background: #10b981; }\n      .metric-fill.error { background: #ef4444; }\n\n      .usage-stats {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 15px;\n      }\n\n      .usage-stat {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 15px;\n        background: #f8f9fa;\n        border-radius: 8px;\n      }\n\n      .stat-icon {\n        font-size: 20px;\n        opacity: 0.8;\n      }\n\n      .stat-value {\n        font-size: 20px;\n        font-weight: bold;\n        color: #333;\n      }\n\n      .stat-label {\n        font-size: 11px;\n        color: #666;\n      }\n\n      .network-stats {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n        gap: 15px;\n      }\n\n      .network-stat-card {\n        padding: 15px;\n        background: #f8f9fa;\n        border-radius: 8px;\n      }\n\n      .network-stat-card h4 {\n        margin: 0 0 12px 0;\n        font-size: 14px;\n        color: #333;\n      }\n\n      .network-detail {\n        font-size: 12px;\n      }\n\n      .ip-name, .network-size, .avg-size {\n        font-weight: bold;\n        color: #333;\n        margin-bottom: 4px;\n      }\n\n      .ip-id, .network-depth, .network-root, .network-trend {\n        color: #666;\n        margin-bottom: 2px;\n      }\n\n      .revenue-overview {\n        display: grid;\n        grid-template-columns: 1fr 2fr;\n        gap: 20px;\n        align-items: start;\n      }\n\n      .revenue-total {\n        text-align: center;\n        padding: 20px;\n        background: linear-gradient(135deg, #667eea, #764ba2);\n        color: white;\n        border-radius: 12px;\n      }\n\n      .total-amount {\n        font-size: 28px;\n        font-weight: bold;\n        margin-bottom: 8px;\n      }\n\n      .total-label {\n        font-size: 12px;\n        opacity: 0.9;\n      }\n\n      .revenue-distribution {\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n      }\n\n      .distribution-item {\n        display: flex;\n        align-items: center;\n        gap: 10px;\n      }\n\n      .dist-label {\n        flex: 1;\n        font-size: 12px;\n        color: #666;\n      }\n\n      .dist-value {\n        font-size: 12px;\n        font-weight: 600;\n        color: #333;\n        min-width: 80px;\n        text-align: right;\n      }\n\n      .dist-bar {\n        flex: 2;\n        height: 8px;\n        background: #e5e7eb;\n        border-radius: 4px;\n        overflow: hidden;\n      }\n\n      .dist-fill {\n        height: 100%;\n        transition: width 0.3s ease;\n      }\n\n      .dist-fill.original { background: #667eea; }\n      .dist-fill.derivative { background: #10b981; }\n      .dist-fill.license { background: #f59e0b; }\n\n      .charts-container {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n        gap: 20px;\n      }\n\n      .chart-card {\n        background: #f8f9fa;\n        border-radius: 8px;\n        padding: 15px;\n      }\n\n      .chart-card h4 {\n        margin: 0 0 15px 0;\n        font-size: 14px;\n        color: #333;\n      }\n\n      .chart-placeholder {\n        height: 200px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        background: white;\n        border-radius: 6px;\n      }\n\n      .simple-chart {\n        display: flex;\n        align-items: end;\n        gap: 8px;\n        height: 150px;\n        padding: 10px;\n      }\n\n      .chart-day, .chart-month {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        gap: 5px;\n      }\n\n      .chart-bars {\n        display: flex;\n        align-items: end;\n        gap: 2px;\n        height: 120px;\n      }\n\n      .chart-bar {\n        width: 12px;\n        border-radius: 2px 2px 0 0;\n        min-height: 2px;\n        transition: all 0.3s ease;\n      }\n\n      .chart-bar.searches, .chart-bar.new-ips { background: #667eea; }\n      .chart-bar.visualizations, .chart-bar.new-relationships { background: #10b981; }\n\n      .chart-label {\n        font-size: 10px;\n        color: #666;\n        text-align: center;\n      }\n\n      .chart-legend {\n        display: flex;\n        justify-content: center;\n        gap: 20px;\n        margin-top: 10px;\n      }\n\n      .legend-item {\n        display: flex;\n        align-items: center;\n        gap: 6px;\n        font-size: 11px;\n        color: #666;\n      }\n\n      .legend-color {\n        width: 12px;\n        height: 12px;\n        border-radius: 2px;\n      }\n\n      .legend-color.searches, .legend-color.new-ips { background: #667eea; }\n      .legend-color.visualizations, .legend-color.new-relationships { background: #10b981; }\n\n      .top-searches-list {\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n      }\n\n      .search-item {\n        display: flex;\n        align-items: center;\n        gap: 15px;\n        padding: 15px;\n        background: #f8f9fa;\n        border-radius: 8px;\n        cursor: pointer;\n        transition: background 0.2s ease;\n      }\n\n      .search-item:hover {\n        background: #e9ecef;\n      }\n\n      .search-rank {\n        font-size: 16px;\n        font-weight: bold;\n        color: #667eea;\n        min-width: 30px;\n      }\n\n      .search-details {\n        flex: 1;\n      }\n\n      .search-name {\n        font-size: 13px;\n        font-weight: 600;\n        color: #333;\n        margin-bottom: 4px;\n      }\n\n      .search-id {\n        font-size: 11px;\n        font-family: monospace;\n        color: #666;\n        margin-bottom: 4px;\n      }\n\n      .search-meta {\n        display: flex;\n        gap: 15px;\n        font-size: 10px;\n        color: #888;\n      }\n\n      .search-actions {\n        display: flex;\n        gap: 8px;\n      }\n\n      .search-again-btn {\n        background: #667eea;\n        color: white;\n        border: none;\n        border-radius: 6px;\n        padding: 8px 12px;\n        cursor: pointer;\n        font-size: 12px;\n        transition: background 0.2s ease;\n      }\n\n      .search-again-btn:hover {\n        background: #5a67d8;\n      }\n\n      @media (max-width: 768px) {\n        .overview-cards {\n          grid-template-columns: 1fr;\n        }\n        \n        .revenue-overview {\n          grid-template-columns: 1fr;\n        }\n        \n        .charts-container {\n          grid-template-columns: 1fr;\n          max-width: 100%;\n          overflow-x: auto;\n        }\n      }\n    ",document.head.appendChild(t)}}const Ka=i.p+"assets/5aa84849832f7c5978fb.png";let Qa=null,Za=null,to=null,eo={totalIPs:0,totalRelationships:0,avgDerivatives:0};async function no(t){if(!Qa||!Za)return;const e=performance.now();let n=!1;try{io(!0);const e=await Za.getIPAsset(t),r=await Za.getIPRelationships(t);to&&(to.trackSearch(t,e.name||"Unknown IP"),to.trackVisualization(r.length),to.updateRevenue(e.revenue||0)),eo.totalIPs++,eo.totalRelationships+=r.length,eo.avgDerivatives=eo.totalRelationships/eo.totalIPs,function(){const t=document.getElementById("total-ips"),e=document.getElementById("total-relationships"),n=document.getElementById("avg-derivatives");if(t&&(t.textContent=eo.totalIPs.toString()),e&&(e.textContent=eo.totalRelationships.toString()),n){const t=eo.totalIPs>0?(eo.totalRelationships/eo.totalIPs).toFixed(1):"0";n.textContent=t}}(),await Qa.loadIPRelationships(t,e,r),function(t,e){const n=document.getElementById("ip-details");if(!n)return;let r=`\n    <div class="ip-info">\n      <h3>ðŸ“‹ IP Asset Details</h3>\n      <div class="info-grid">\n        <div class="info-item">\n          <span class="label">ID:</span>\n          <span class="value">${t.id}</span>\n        </div>\n        <div class="info-item">\n          <span class="label">Name:</span>\n          <span class="value">${t.name||"Unknown"}</span>\n        </div>\n        <div class="info-item">\n          <span class="label">Owner:</span>\n          <span class="value">${t.owner||"Unknown"}</span>\n        </div>\n        <div class="info-item">\n          <span class="label">Type:</span>\n          <span class="value">${t.type||"IP Asset"}</span>\n        </div>\n        <div class="info-item">\n          <span class="label">Created:</span>\n          <span class="value">${t.createdAt?new Date(t.createdAt).toLocaleDateString():"Unknown"}</span>\n        </div>\n        <div class="info-item">\n          <span class="label">Revenue:</span>\n          <span class="value">$${(t.revenue||0).toLocaleString()}</span>\n        </div>\n        <div class="info-item">\n          <span class="label">Derivatives:</span>\n          <span class="value">${e.filter(t=>"derivative"===t.type).length}</span>\n        </div>\n      </div>\n    </div>\n  `;t.metadata&&(r+='\n      <div class="metadata-section">\n        <h4>ðŸ“ Metadata</h4>\n        <div class="metadata-grid">\n    ',t.metadata.title&&(r+=`\n        <div class="metadata-item">\n          <span class="metadata-label">Title:</span>\n          <span class="metadata-value">${t.metadata.title}</span>\n        </div>\n      `),t.metadata.description&&(r+=`\n        <div class="metadata-item">\n          <span class="metadata-label">Description:</span>\n          <span class="metadata-value">${t.metadata.description}</span>\n        </div>\n      `),t.metadata.image&&(r+=`\n        <div class="metadata-item full-width">\n          <span class="metadata-label">Image:</span>\n          <div class="metadata-image">\n            <img src="${t.metadata.image}" alt="IP Asset Image" style="max-width: 200px; max-height: 200px; border-radius: 8px; margin-top: 8px;">\n          </div>\n        </div>\n      `),t.metadata.mediaUrl&&(r+=`\n        <div class="metadata-item">\n          <span class="metadata-label">Media URL:</span>\n          <span class="metadata-value">\n            <a href="${t.metadata.mediaUrl}" target="_blank" style="color: #667eea; text-decoration: none;">\n              ${t.metadata.mediaUrl.length>50?t.metadata.mediaUrl.substring(0,50)+"...":t.metadata.mediaUrl}\n            </a>\n          </span>\n        </div>\n      `),t.metadata.mediaType&&(r+=`\n        <div class="metadata-item">\n          <span class="metadata-label">Media Type:</span>\n          <span class="metadata-value">${t.metadata.mediaType}</span>\n        </div>\n      `),t.metadata.creators&&t.metadata.creators.length>0&&(r+='\n        <div class="metadata-item full-width">\n          <span class="metadata-label">Creators:</span>\n          <div class="creators-list">\n      ',t.metadata.creators.forEach(t=>{r+=`\n          <div class="creator-item">\n            <div class="creator-name">${t.name}</div>\n            <div class="creator-address">${t.address}</div>\n            ${t.contributionPercent?`<div class="creator-contribution">${t.contributionPercent}% contribution</div>`:""}\n          </div>\n        `}),r+="\n          </div>\n        </div>\n      "),t.tags&&t.tags.length>0&&(r+=`\n        <div class="metadata-item full-width">\n          <span class="metadata-label">Tags:</span>\n          <div class="tags-container">\n            ${t.tags.map(t=>`<span class="tag">${t}</span>`).join("")}\n          </div>\n        </div>\n      `),r+="\n        </div>\n      </div>\n    "),e.length>0&&(r+=`\n      <div class="relationships">\n        <h4>ðŸ”— Relationships (${e.length})</h4>\n        <div class="relationship-list">\n    `,e.forEach(t=>{r+=`\n        <div class="relationship-item">\n          <span class="rel-type">${t.type}</span>\n          <span class="rel-target">${t.target.slice(0,10)}...${t.target.slice(-8)}</span>\n          ${t.name?`<span class="rel-name">${t.name}</span>`:""}\n          ${t.revenue?`<span class="rel-revenue">$${t.revenue.toLocaleString()}</span>`:""}\n        </div>\n      `}),r+="\n        </div>\n      </div>\n    "),n.innerHTML=r}(e,r),n=!0,io(!1)}catch(t){console.error("Failed to analyze IP:",t),ao("Failed to analyze IP. Please check the ID and try again."),io(!1)}finally{const t=(performance.now()-e)/1e3;to&&to.trackPerformance(t,n)}}function ro(){Qa&&Qa.clear();const t=document.getElementById("ip-details");t&&(t.innerHTML='\n      <div class="placeholder">\n        <span class="placeholder-icon">ðŸŽ¯</span>\n        <p>Search for an IP Asset to see its relationship graph</p>\n      </div>\n    ');const e=document.getElementById("search");e&&(e.value="")}function io(t){const e=document.getElementById("graph-loading");e&&e.classList.toggle("hidden",!t)}function ao(t){const e=document.getElementById("ip-details");e&&(e.innerHTML=`\n      <div class="error-message">\n        <span class="error-icon">âŒ</span>\n        <p>${t}</p>\n      </div>\n    `)}function oo(t){const e=document.createElement("div");e.className="detected-ips-panel",e.innerHTML=`\n    <div class="detected-header">\n      <span class="detected-icon">ðŸ”</span>\n      <span class="detected-title">Detected IPs (${t.length})</span>\n      <button class="detected-close">âœ•</button>\n    </div>\n    <div class="detected-list">\n      ${t.slice(0,10).map((t,e)=>`\n        <div class="detected-item" data-ip="${t.ip}">\n          <div class="detected-ip">${t.ip.slice(0,12)}...${t.ip.slice(-8)}</div>\n          <div class="detected-type">${t.type}</div>\n          <div class="detected-context">${t.context?.slice(0,40)}...</div>\n          <button class="analyze-ip-btn" data-ip="${t.ip}">ðŸ”</button>\n        </div>\n      `).join("")}\n      ${t.length>10?`<div class="detected-more">+${t.length-10} more IPs detected</div>`:""}\n    </div>\n  `,e.style.cssText="\n    background: white;\n    border: 1px solid #e5e7eb;\n    border-radius: 8px;\n    margin: 10px 0;\n    max-height: 300px;\n    overflow-y: auto;\n  ";const n=document.querySelector(".search-section");n&&n.parentNode?.insertBefore(e,n.nextSibling),e.querySelectorAll(".analyze-ip-btn").forEach(t=>{t.addEventListener("click",e=>{e.stopPropagation();const n=t.getAttribute("data-ip");if(n){const t=document.getElementById("search");t&&(t.value=n,no(n))}})});const r=e.querySelector(".detected-close");r?.addEventListener("click",()=>{e.remove()})}document.addEventListener("DOMContentLoaded",async()=>{console.log("IP Graph Extension popup loaded"),"true"===localStorage.getItem("darkMode")&&document.body.classList.add("dark-mode");const t=document.getElementById("logo-icon");t&&(t.src=Ka),function(){const t=document.querySelectorAll(".tab-button"),e=document.querySelectorAll(".tab-content");t.forEach(n=>{n.addEventListener("click",r=>{const i=r.target.getAttribute("data-tab");t.forEach(t=>t.classList.remove("active")),e.forEach(t=>t.classList.remove("active")),n.classList.add("active");const a=document.getElementById(i);a&&a.classList.add("active")})})}(),function(){const t=document.getElementById("search"),e=document.getElementById("visualize"),n=document.getElementById("random-ip"),r=document.getElementById("clear-graph");e?.addEventListener("click",async()=>{const e=t?.value.trim();e&&await no(e)}),t?.addEventListener("keypress",async e=>{if("Enter"===e.key){const e=t.value.trim();e&&await no(e)}}),n?.addEventListener("click",async()=>{if(Za)try{n.disabled=!0,n.innerHTML="ðŸ”„ Scraping...",io(!0);const e=await Za.getRandomIP();if(e&&t){t.value=e;const n=document.createElement("div");n.style.cssText="\n        position: fixed; top: 20px; right: 20px; padding: 12px 20px;\n        background: linear-gradient(135deg, #10b981, #059669); color: white;\n        border-radius: 8px; font-size: 13px; z-index: 10001;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.2);\n      ",n.textContent=`âœ… Found IP: ${e.slice(0,10)}...${e.slice(-6)}`,document.body.appendChild(n),setTimeout(()=>n.remove(),3e3),await no(e)}}catch(t){console.error("Failed to get random IP:",t),ao("Could not extract IP addresses from Story Explorer. The page structure may have changed.")}finally{n.disabled=!1,n.innerHTML="ðŸŽ² Random",io(!1)}}),r?.addEventListener("click",()=>{ro()})}(),function(){const t=document.getElementById("connect-wallet"),e=document.getElementById("disconnect-wallet");t?.addEventListener("click",async()=>{try{await async function(){try{p("connecting","Choose connection method..."),function(){const t=document.createElement("div");t.className="wallet-modal-overlay",t.style.cssText="\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.5);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 10000;\n  ";const e=document.createElement("div");e.className="wallet-modal",e.style.cssText="\n    background: white;\n    border-radius: 16px;\n    padding: 24px;\n    width: 320px;\n    max-width: 90vw;\n    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n    position: relative;\n  ",e.innerHTML='\n    <div class="wallet-modal-header">\n      <h3 style="margin: 0 0 16px 0; color: #333; font-size: 18px;">Connect Wallet</h3>\n      <button class="close-modal" style="position: absolute; top: 16px; right: 16px; background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">Ã—</button>\n    </div>\n    <div class="wallet-options">\n      <button class="wallet-option metamask-option" style="\n        width: 100%;\n        padding: 16px;\n        margin-bottom: 12px;\n        border: 2px solid #e5e7eb;\n        border-radius: 12px;\n        background: white;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        transition: all 0.2s ease;\n      ">\n        <div style="width: 32px; height: 32px; background: linear-gradient(135deg, #f6851b, #e2761b); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">M</div>\n        <div style="text-align: left;">\n          <div style="font-weight: 600; color: #333; margin-bottom: 2px;">MetaMask</div>\n          <div style="font-size: 12px; color: #666;">Browser extension</div>\n        </div>\n      </button>\n      \n      <button class="wallet-option walletconnect-option" style="\n        width: 100%;\n        padding: 16px;\n        border: 2px solid #e5e7eb;\n        border-radius: 12px;\n        background: white;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        transition: all 0.2s ease;\n      ">\n        <div style="width: 32px; height: 32px; background: linear-gradient(135deg, #3b99fc, #1a73e8); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">W</div>\n        <div style="text-align: left;">\n          <div style="font-weight: 600; color: #333; margin-bottom: 2px;">WalletConnect</div>\n          <div style="font-size: 12px; color: #666;">Mobile & other wallets</div>\n        </div>\n      </button>\n    </div>\n  ',t.appendChild(e),document.body.appendChild(t),e.querySelectorAll(".wallet-option").forEach(t=>{t.addEventListener("mouseenter",()=>{t.style.borderColor="#667eea",t.style.transform="translateY(-2px)"}),t.addEventListener("mouseleave",()=>{t.style.borderColor="#e5e7eb",t.style.transform="translateY(0)"})});const n=()=>{document.body.removeChild(t),p("connecting","Connect to Story Protocol")};e.querySelector(".close-modal")?.addEventListener("click",n),t.addEventListener("click",e=>{e.target===t&&n()}),e.querySelector(".metamask-option")?.addEventListener("click",()=>{n(),async function(){try{if(p("connecting","Connecting to MetaMask..."),void 0===window.ethereum)throw new Error("MetaMask not found. Please install MetaMask extension.");const t=window.ethereum,e=await t.request({method:"eth_requestAccounts"});if(0===e.length)throw new Error("No accounts found. Please unlock your wallet.");const n=e[0],r=await t.request({method:"eth_chainId"});parseInt(r,16)!==c&&await async function(t){try{await t.request({method:"wallet_switchEthereumChain",params:[{chainId:`0x${c.toString(16)}`}]})}catch(e){if(4902!==e.code)throw e;await t.request({method:"wallet_addEthereumChain",params:[{chainId:`0x${c.toString(16)}`,chainName:"Story Aeneid Testnet",nativeCurrency:{name:"IP",symbol:"IP",decimals:18},rpcUrls:[l],blockExplorerUrls:["https://aeneid.storyscan.io"]}]})}}(t);const i=await t.request({method:"eth_getBalance",params:[n,"latest"]}),a=parseInt(i,16)/Math.pow(10,18);o={address:n,balance:a.toFixed(4),connected:!0,chainId:c,provider:"MetaMask",network:"Story Aeneid Testnet"},p("connected","Connected via MetaMask"),f(),await y(),v(),function(t){t.on("accountsChanged",t=>{if(0===t.length)h();else{const e=t[0];o&&(o.address=e,f())}}),t.on("chainChanged",t=>{parseInt(t,16)!==c&&d()})}(t)}catch(t){console.error("MetaMask connection failed:",t),p("error","MetaMask connection failed"),m(t)}}()}),e.querySelector(".walletconnect-option")?.addEventListener("click",()=>{n(),async function(){try{p("connecting","Initializing WalletConnect...");const{WalletConnectModal:t}=await i.e(940).then(i.bind(i,940)),{EthereumProvider:e}=await i.e(9105).then(i.bind(i,9105));s=await e.init({projectId:u,chains:[c],rpcMap:{[c]:l},metadata:{name:"IP Graph Extension",description:"Visualize IP Asset relationships on Story Protocol",url:"https://your-app-url.com",icons:["https://your-app-url.com/icon.png"]},showQrModal:!0,qrModalOptions:{themeMode:"light",themeVariables:{"--wcm-z-index":"10000"}}}),new t({projectId:u,chains:[c.toString()]}),p("connecting","Scan QR code with your wallet..."),await s.connect();const n=s.accounts;if(0===n.length)throw new Error("No accounts connected");const r=n[0],a=await s.request({method:"eth_getBalance",params:[r,"latest"]}),m=parseInt(a,16)/Math.pow(10,18);o={address:r,balance:m.toFixed(4),connected:!0,chainId:c,provider:"WalletConnect",network:"Story Aeneid Testnet"},p("connected","Connected via WalletConnect"),f(),await y(),v(),s&&(s.on("accountsChanged",t=>{if(0===t.length)h();else{const e=t[0];o&&(o.address=e,f())}}),s.on("chainChanged",t=>{t!==c&&d()}),s.on("disconnect",()=>{h()}))}catch(t){console.error("WalletConnect connection failed:",t),p("error","WalletConnect connection failed"),m(t)}}()})}()}catch(t){console.error("Wallet connection failed:",t),p("error","Connection failed"),m(t)}}()}catch(t){console.error("Failed to connect wallet:",t)}}),e?.addEventListener("click",async()=>{try{await async function(){try{s&&await s.disconnect(),h()}catch(t){console.error("Error disconnecting:",t)}}()}catch(t){console.error("Failed to disconnect wallet:",t)}})}(),function(){const t=document.getElementById("analytics-content");t&&(to=new Ja(t),to.render()),document.addEventListener("searchIP",t=>{const{ipId:e}=t.detail,n=document.getElementById("search");n&&(n.value=e,no(e))})}(),Za=new Ya;const e=document.getElementById("graph-canvas");e&&(Qa=new Ir(e)),async function(){try{const t=await chrome.runtime.sendMessage({action:"getStoredIP"});if(console.log("Stored IP data:",t),t.selectedIP){const e=document.getElementById("search");e&&(e.value=t.selectedIP,t.fromContextMenu&&function(t){const e=document.createElement("div");e.className="context-info-panel",e.innerHTML=`\n    <div class="context-header">\n      <span class="context-icon">ðŸŽ¯</span>\n      <span class="context-title">IP Detected from Context Menu</span>\n      <button class="context-close">âœ•</button>\n    </div>\n    <div class="context-details">\n      ${t.sourceTitle?`<div class="context-item"><strong>Source:</strong> ${t.sourceTitle}</div>`:""}\n      ${t.sourceUrl?`<div class="context-item"><strong>URL:</strong> ${t.sourceUrl}</div>`:""}\n      ${t.ipType?`<div class="context-item"><strong>Type:</strong> ${t.ipType}</div>`:""}\n      ${t.selectionContext?`<div class="context-item"><strong>Context:</strong> "${t.selectionContext}"</div>`:""}\n      <div class="context-item"><strong>Detected:</strong> ${new Date(t.timestamp).toLocaleString()}</div>\n    </div>\n  `,e.style.cssText="\n    background: linear-gradient(135deg, #667eea, #764ba2);\n    color: white;\n    border-radius: 8px;\n    padding: 15px;\n    margin: 10px 0;\n    font-size: 12px;\n  ";const n=document.querySelector(".search-section");n&&n.parentNode?.insertBefore(e,n);const r=e.querySelector(".context-close");r?.addEventListener("click",()=>{e.remove()}),setTimeout(()=>{e.parentNode&&e.remove()},1e4)}(t),t.fromPageDetection&&t.detectedIPs&&oo(t.detectedIPs),await no(t.selectedIP))}t.detectedIPs&&t.detectedIPs.length>0&&oo(t.detectedIPs)}catch(t){console.error("Failed to check stored IP:",t)}}(),f()});const so=document.getElementById("dark-mode-toggle");so?.addEventListener("click",()=>{const t=document.body.classList.toggle("dark-mode");localStorage.setItem("darkMode",t.toString())}),window.analyzeIP=no,window.clearGraph=ro})();
//# sourceMappingURL=popup.js.map